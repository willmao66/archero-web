window.__require=function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!a&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){return o(e[s][1][t]||t)},u,u.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(){},{}],2:[function(t,e){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}function c(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{return r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}})();var l,u=[],d=!1,h=-1;function f(){d&&l&&(d=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!d){var t=a(f);d=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,d=!1,c(t)}}function g(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new g(t,e)),1!==u.length||d||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(){return[]},o.binding=function(){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],3:[function(){},{}],4:[function(t,e,n){arguments[4][3][0].apply(n,arguments)},{dup:3}],5:[function(t,e,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("tweetnacl-util"),o=t("tweetnacl");function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s,a,c,l,u,d,h=i(r),f=i(o);function p(t,e){const n=h.default.encodeBase64(t);return e?encodeURIComponent(n):n}function g(t,e){return e&&(t=decodeURIComponent(t)),h.default.decodeBase64(t)}n.CONNECT_EVENT_ERROR_CODES=void 0,(s=n.CONNECT_EVENT_ERROR_CODES||(n.CONNECT_EVENT_ERROR_CODES={}))[s.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",s[s.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",s[s.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",s[s.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",s[s.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",s[s.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",s[s.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",n.CONNECT_ITEM_ERROR_CODES=void 0,(a=n.CONNECT_ITEM_ERROR_CODES||(n.CONNECT_ITEM_ERROR_CODES={}))[a.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",a[a.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",n.SEND_TRANSACTION_ERROR_CODES=void 0,(c=n.SEND_TRANSACTION_ERROR_CODES||(n.SEND_TRANSACTION_ERROR_CODES={}))[c.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",c[c.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",c[c.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",c[c.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",c[c.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",n.SIGN_DATA_ERROR_CODES=void 0,(l=n.SIGN_DATA_ERROR_CODES||(n.SIGN_DATA_ERROR_CODES={}))[l.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",l[l.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",l[l.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",l[l.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",l[l.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",n.DISCONNECT_ERROR_CODES=void 0,(u=n.DISCONNECT_ERROR_CODES||(n.DISCONNECT_ERROR_CODES={}))[u.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",u[u.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",u[u.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",u[u.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",n.CHAIN=void 0,(d=n.CHAIN||(n.CHAIN={})).MAINNET="-239",d.TESTNET="-3";const y={encode:function(t,e=!1){let n;return t instanceof Uint8Array?n=t:("string"!=typeof t&&(t=JSON.stringify(t)),n=h.default.decodeUTF8(t)),p(n,e)},decode:function(t,e=!1){const n=g(t,e);return{toString:()=>h.default.encodeUTF8(n),toObject(){try{return JSON.parse(h.default.encodeUTF8(n))}catch(t){return null}},toUint8Array:()=>n}}};function v(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function w(t,e){if(e>=t.length)throw new Error("Index is out of buffer");return[t.slice(0,e),t.slice(e)]}function b(t){let e="";return t.forEach(t=>{e+=("0"+(255&t).toString(16)).slice(-2)}),e}function E(t){if(t.length%2!=0)throw new Error(`Cannot convert ${t} to bytesArray`);const e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n/2]=parseInt(t.slice(n,n+2),16);return e}n.Base64=y,n.SessionCrypto=class{constructor(t){this.nonceLength=24,this.keyPair=t?this.createKeypairFromString(t):this.createKeypair(),this.sessionId=b(this.keyPair.publicKey)}createKeypair(){return f.default.box.keyPair()}createKeypairFromString(t){return{publicKey:E(t.publicKey),secretKey:E(t.secretKey)}}createNonce(){return f.default.randomBytes(this.nonceLength)}encrypt(t,e){const n=(new TextEncoder).encode(t),r=this.createNonce();return v(r,f.default.box(n,r,e,this.keyPair.secretKey))}decrypt(t,e){const[n,r]=w(t,this.nonceLength),o=f.default.box.open(r,n,e,this.keyPair.secretKey);if(!o)throw new Error(`Decryption error: \n message: ${t.toString()} \n sender pubkey: ${e.toString()} \n keypair pubkey: ${this.keyPair.publicKey.toString()} \n keypair secretkey: ${this.keyPair.secretKey.toString()}`);return(new TextDecoder).decode(o)}stringifyKeypair(){return{publicKey:b(this.keyPair.publicKey),secretKey:b(this.keyPair.secretKey)}}},n.concatUint8Arrays=v,n.hexToByteArray=E,n.isNode=function(){return void 0!==e&&null!=e.versions&&null!=e.versions.node},n.splitToUint8Arrays=w,n.toHexString=b}).call(this,t("_process"))},{_process:2,tweetnacl:8,"tweetnacl-util":7}],6:[function(t,e,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@tonconnect/protocol");function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function i(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(e){i(e)}}function a(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})}t("@tonconnect/isomorphic-eventsource"),t("@tonconnect/isomorphic-fetch");class s extends Error{constructor(t,e){super(t,e),this.message=`${s.prefix} ${this.constructor.name}${this.info?": "+this.info:""}${t?"\n"+t:""}`,Object.setPrototypeOf(this,s.prototype)}get info(){return""}}s.prefix="[TON_CONNECT_SDK_ERROR]";class a extends s{get info(){return"Passed DappMetadata is in incorrect format."}constructor(...t){super(...t),Object.setPrototypeOf(this,a.prototype)}}class c extends s{get info(){return"Passed `tonconnect-manifest.json` contains errors. Check format of your manifest. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...t){super(...t),Object.setPrototypeOf(this,c.prototype)}}class l extends s{get info(){return"Manifest not found. Make sure you added `tonconnect-manifest.json` to the root of your app or passed correct manifestUrl. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...t){super(...t),Object.setPrototypeOf(this,l.prototype)}}class u extends s{get info(){return"Wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection."}constructor(...t){super(...t),Object.setPrototypeOf(this,u.prototype)}}class d extends s{get info(){return"Send transaction or other protocol methods called while wallet is not connected."}constructor(...t){super(...t),Object.setPrototypeOf(this,d.prototype)}}class h extends s{get info(){return"User rejects the action in the wallet."}constructor(...t){super(...t),Object.setPrototypeOf(this,h.prototype)}}class f extends s{get info(){return"Request to the wallet contains errors."}constructor(...t){super(...t),Object.setPrototypeOf(this,f.prototype)}}class p extends s{get info(){return"App tries to send rpc request to the injected wallet while not connected."}constructor(...t){super(...t),Object.setPrototypeOf(this,p.prototype)}}class g extends s{get info(){return"There is an attempt to connect to the injected wallet while it is not exists in the webpage."}constructor(...t){super(...t),Object.setPrototypeOf(this,g.prototype)}}class y extends s{get info(){return"Storage was not specified in the `DappMetadata` and default `localStorage` was not detected in the environment."}constructor(...t){super(...t),Object.setPrototypeOf(this,y.prototype)}}class v extends s{get info(){return"An error occurred while fetching the wallets list."}constructor(...t){super(...t),Object.setPrototypeOf(this,v.prototype)}}class w extends s{get info(){return"Passed address is in incorrect format."}constructor(...t){super(...t),Object.setPrototypeOf(this,w.prototype)}}class b extends s{get info(){return"Passed hex is in incorrect format."}constructor(...t){super(...t),Object.setPrototypeOf(this,b.prototype)}}class E extends s{constructor(...t){super(...t),Object.setPrototypeOf(this,E.prototype)}}const m={[r.CONNECT_EVENT_ERROR_CODES.UNKNOWN_ERROR]:E,[r.CONNECT_EVENT_ERROR_CODES.USER_REJECTS_ERROR]:h,[r.CONNECT_EVENT_ERROR_CODES.BAD_REQUEST_ERROR]:f,[r.CONNECT_EVENT_ERROR_CODES.UNKNOWN_APP_ERROR]:p,[r.CONNECT_EVENT_ERROR_CODES.MANIFEST_NOT_FOUND_ERROR]:l,[r.CONNECT_EVENT_ERROR_CODES.MANIFEST_CONTENT_ERROR]:c},_=new class{parseError(t){let e=E;return t.code in m&&(e=m[t.code]||E),new e(t.message)}};const R={[r.SEND_TRANSACTION_ERROR_CODES.UNKNOWN_ERROR]:E,[r.SEND_TRANSACTION_ERROR_CODES.USER_REJECTS_ERROR]:h,[r.SEND_TRANSACTION_ERROR_CODES.BAD_REQUEST_ERROR]:f,[r.SEND_TRANSACTION_ERROR_CODES.UNKNOWN_APP_ERROR]:p},S=new class extends class{isError(t){return"error"in t}}{convertToRpcRequest(t){return{method:"sendTransaction",params:[JSON.stringify(t)]}}parseAndThrowError(t){let e=E;throw t.error.code in R&&(e=R[t.error.code]||E),new e(t.error.message)}convertFromRpcResponse(t){return{boc:t.result}}};class C{constructor(t,e){this.storage=t,this.storeKey="ton-connect-storage_http-bridge-gateway::"+e}storeLastEventId(t){return i(this,void 0,void 0,function*(){return this.storage.setItem(this.storeKey,t)})}removeLastEventId(){return i(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getLastEventId(){return i(this,void 0,void 0,function*(){return(yield this.storage.getItem(this.storeKey))||null})}}function O(t){return"/"===t.slice(-1)?t.slice(0,-1):t}function T(t,e){return O(t)+"/"+e}function N(t){if(!t)return!1;const e=new URL(t);return"tg:"===e.protocol||"t.me"===e.hostname}function A(t){return t.replaceAll(".","%2E").replaceAll("-","%2D").replaceAll("_","%5F").replaceAll("&","-").replaceAll("=","__").replaceAll("%","--")}function U(t,e){return i(this,void 0,void 0,function*(){return new Promise((n,r)=>{var o,i;if(null===(o=null==e?void 0:e.signal)||void 0===o?void 0:o.aborted)return void r(new s("Delay aborted"));const a=setTimeout(()=>n(),t);null===(i=null==e?void 0:e.signal)||void 0===i||i.addEventListener("abort",()=>{clearTimeout(a),r(new s("Delay aborted"))})})})}function k(t){const e=new AbortController;return(null==t?void 0:t.aborted)?e.abort():null==t||t.addEventListener("abort",()=>e.abort(),{once:!0}),e}function P(t,e){var n,r;return i(this,void 0,void 0,function*(){const o=null!==(n=null==e?void 0:e.attempts)&&void 0!==n?n:10,i=null!==(r=null==e?void 0:e.delayMs)&&void 0!==r?r:200,a=k(null==e?void 0:e.signal);if("function"!=typeof t)throw new s(`Expected a function, got ${typeof t}`);let c,l=0;for(;l<o;){if(a.signal.aborted)throw new s(`Aborted after attempts ${l}`);try{return yield t({signal:a.signal})}catch(u){c=u,++l<o&&(yield U(i))}}throw c})}function I(...t){try{console.debug("[TON_CONNECT_SDK]",...t)}catch(e){}}function j(...t){try{console.error("[TON_CONNECT_SDK]",...t)}catch(e){}}function D(...t){try{console.warn("[TON_CONNECT_SDK]",...t)}catch(e){}}function L(t,e){let n=null,r=null,o=null,a=null,c=null;const l=(l,...u)=>i(this,void 0,void 0,function*(){if(a=null!=l?l:null,null==c||c.abort(),(c=k(l)).signal.aborted)throw new s("Resource creation was aborted");r=null!=u?u:null;const i=t(c.signal,...u);o=i;const d=yield i;if(o!==i&&d!==n)throw yield e(d),new s("Resource creation was aborted by a new resource creation");return n=d});return{create:l,current:()=>null!=n?n:null,dispose:()=>i(this,void 0,void 0,function*(){try{const r=n;n=null;const i=o;o=null;try{null==c||c.abort()}catch(t){}yield Promise.allSettled([r?e(r):Promise.resolve(),i?e(yield i):Promise.resolve()])}catch(t){}}),recreate:t=>i(this,void 0,void 0,function*(){const e=n,i=o,c=r,u=a;if(yield U(t),e===n&&i===o&&c===r&&u===a)return yield l(a,...null!=c?c:[]);throw new s("Resource recreation was aborted by a new resource creation")})}}function x(t,e){const n=null==e?void 0:e.timeout,r=k(null==e?void 0:e.signal);return new Promise((e,o)=>{if(r.signal.aborted)return void o(new s("Operation aborted"));let i;void 0!==n&&(i=setTimeout(()=>{r.abort(),o(new s(`Timeout after ${n}ms`))},n)),r.signal.addEventListener("abort",()=>{clearTimeout(i),o(new s("Operation aborted"))},{once:!0});const a={timeout:n,abort:r.signal};t(e,o,a).finally(()=>clearTimeout(i))})}class M{constructor(t,e,n,r,o){this.bridgeUrl=e,this.sessionId=n,this.listener=r,this.errorsListener=o,this.ssePath="events",this.postPath="message",this.heartbeatMessage="heartbeat",this.defaultTtl=300,this.defaultReconnectDelay=5e3,this.eventSource=L((t,e)=>i(this,void 0,void 0,function*(){const n={bridgeUrl:this.bridgeUrl,ssePath:this.ssePath,sessionId:this.sessionId,bridgeGatewayStorage:this.bridgeGatewayStorage,errorHandler:this.errorsHandler.bind(this),messageHandler:this.messagesHandler.bind(this),signal:t,openingDeadlineMS:e};return yield W(n)}),t=>i(this,void 0,void 0,function*(){t.close()})),this.bridgeGatewayStorage=new C(t,e)}get isReady(){const t=this.eventSource.current();return(null==t?void 0:t.readyState)===EventSource.OPEN}get isClosed(){const t=this.eventSource.current();return(null==t?void 0:t.readyState)!==EventSource.OPEN}get isConnecting(){const t=this.eventSource.current();return(null==t?void 0:t.readyState)===EventSource.CONNECTING}registerSession(t){return i(this,void 0,void 0,function*(){yield this.eventSource.create(null==t?void 0:t.signal,null==t?void 0:t.openingDeadlineMS)})}send(t,e,n,o){var a;return i(this,void 0,void 0,function*(){const c={};"number"==typeof o?c.ttl=o:(c.ttl=null==o?void 0:o.ttl,c.signal=null==o?void 0:o.signal,c.attempts=null==o?void 0:o.attempts);const l=new URL(T(this.bridgeUrl,this.postPath));l.searchParams.append("client_id",this.sessionId),l.searchParams.append("to",e),l.searchParams.append("ttl",((null==c?void 0:c.ttl)||this.defaultTtl).toString()),l.searchParams.append("topic",n);const u=r.Base64.encode(t);yield P(t=>i(this,void 0,void 0,function*(){const e=yield this.post(l,u,t.signal);if(!e.ok)throw new s(`Bridge send failed, status ${e.status}`)}),{attempts:null!==(a=null==c?void 0:c.attempts)&&void 0!==a?a:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:null==c?void 0:c.signal})})}pause(){this.eventSource.dispose().catch(t=>j(`Bridge pause failed, ${t}`))}unPause(){return i(this,void 0,void 0,function*(){yield this.eventSource.recreate(0)})}close(){return i(this,void 0,void 0,function*(){yield this.eventSource.dispose().catch(t=>j(`Bridge close failed, ${t}`))})}setListener(t){this.listener=t}setErrorsListener(t){this.errorsListener=t}post(t,e,n){return i(this,void 0,void 0,function*(){const r=yield fetch(t,{method:"post",body:e,signal:n});if(!r.ok)throw new s(`Bridge send failed, status ${r.status}`);return r})}errorsHandler(t,e){return i(this,void 0,void 0,function*(){if(this.isConnecting)j("Bridge error",JSON.stringify(e));else{if(!this.isReady){if(this.isClosed)return t.close(),I(`Bridge reconnecting, ${this.defaultReconnectDelay}ms delay`),yield this.eventSource.recreate(this.defaultReconnectDelay);throw new s("Bridge error, unknown state")}try{this.errorsListener(e)}catch(e){}}})}messagesHandler(t){return i(this,void 0,void 0,function*(){if(t.data===this.heartbeatMessage)return;if(yield this.bridgeGatewayStorage.storeLastEventId(t.lastEventId),this.isClosed)return;let e;try{e=JSON.parse(t.data)}catch(t){throw new s(`Bridge message parse failed, message ${t.data}`)}this.listener(e)})}}function W(t){return i(this,void 0,void 0,function*(){return yield x((e,n,r)=>i(this,void 0,void 0,function*(){var o;const a=k(r.signal).signal;if(a.aborted)return void n(new s("Bridge connection aborted"));const c=new URL(T(t.bridgeUrl,t.ssePath));c.searchParams.append("client_id",t.sessionId);const l=yield t.bridgeGatewayStorage.getLastEventId();if(l&&c.searchParams.append("last_event_id",l),a.aborted)return void n(new s("Bridge connection aborted"));const u=new EventSource(c.toString());u.onerror=r=>i(this,void 0,void 0,function*(){if(a.aborted)return u.close(),void n(new s("Bridge connection aborted"));try{const i=yield t.errorHandler(u,r);i!==u&&u.close(),i&&i!==u&&e(i)}catch(o){u.close(),n(o)}}),u.onopen=()=>{if(a.aborted)return u.close(),void n(new s("Bridge connection aborted"));e(u)},u.onmessage=e=>{if(a.aborted)return u.close(),void n(new s("Bridge connection aborted"));t.messageHandler(e)},null===(o=t.signal)||void 0===o||o.addEventListener("abort",()=>{u.close(),n(new s("Bridge connection aborted"))})}),{timeout:t.openingDeadlineMS,signal:t.signal})})}function K(t){return!("connectEvent"in t)}class B{constructor(t){this.storage=t,this.storeKey="ton-connect-storage_bridge-connection"}storeConnection(t){return i(this,void 0,void 0,function*(){if("injected"===t.type)return this.storage.setItem(this.storeKey,JSON.stringify(t));if(!K(t)){const e={sessionKeyPair:t.session.sessionCrypto.stringifyKeypair(),walletPublicKey:t.session.walletPublicKey,bridgeUrl:t.session.bridgeUrl},n={type:"http",connectEvent:t.connectEvent,session:e,lastWalletEventId:t.lastWalletEventId,nextRpcRequestId:t.nextRpcRequestId};return this.storage.setItem(this.storeKey,JSON.stringify(n))}const e={type:"http",connectionSource:t.connectionSource,sessionCrypto:t.sessionCrypto.stringifyKeypair()};return this.storage.setItem(this.storeKey,JSON.stringify(e))})}removeConnection(){return i(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getConnection(){return i(this,void 0,void 0,function*(){const t=yield this.storage.getItem(this.storeKey);if(!t)return null;const e=JSON.parse(t);if("injected"===e.type)return e;if("connectEvent"in e){const t=new r.SessionCrypto(e.session.sessionKeyPair);return{type:"http",connectEvent:e.connectEvent,lastWalletEventId:e.lastWalletEventId,nextRpcRequestId:e.nextRpcRequestId,session:{sessionCrypto:t,bridgeUrl:e.session.bridgeUrl,walletPublicKey:e.session.walletPublicKey}}}return{type:"http",sessionCrypto:new r.SessionCrypto(e.sessionCrypto),connectionSource:e.connectionSource}})}getHttpConnection(){return i(this,void 0,void 0,function*(){const t=yield this.getConnection();if(!t)throw new s("Trying to read HTTP connection source while nothing is stored");if("injected"===t.type)throw new s("Trying to read HTTP connection source while injected connection is stored");return t})}getHttpPendingConnection(){return i(this,void 0,void 0,function*(){const t=yield this.getConnection();if(!t)throw new s("Trying to read HTTP connection source while nothing is stored");if("injected"===t.type)throw new s("Trying to read HTTP connection source while injected connection is stored");if(!K(t))throw new s("Trying to read HTTP-pending connection while http connection is stored");return t})}getInjectedConnection(){return i(this,void 0,void 0,function*(){const t=yield this.getConnection();if(!t)throw new s("Trying to read Injected bridge connection source while nothing is stored");if("http"===(null==t?void 0:t.type))throw new s("Trying to read Injected bridge connection source while HTTP connection is stored");return t})}storedConnectionType(){return i(this,void 0,void 0,function*(){const t=yield this.storage.getItem(this.storeKey);return t?JSON.parse(t).type:null})}storeLastWalletEventId(t){return i(this,void 0,void 0,function*(){const e=yield this.getConnection();if(e&&"http"===e.type&&!K(e))return e.lastWalletEventId=t,this.storeConnection(e)})}getLastWalletEventId(){return i(this,void 0,void 0,function*(){const t=yield this.getConnection();if(t&&"lastWalletEventId"in t)return t.lastWalletEventId})}increaseNextRpcRequestId(){return i(this,void 0,void 0,function*(){const t=yield this.getConnection();if(t&&"nextRpcRequestId"in t){const e=t.nextRpcRequestId||0;return t.nextRpcRequestId=e+1,this.storeConnection(t)}})}getNextRpcRequestId(){return i(this,void 0,void 0,function*(){const t=yield this.getConnection();return t&&"nextRpcRequestId"in t&&t.nextRpcRequestId||0})}}const q=2;class F{constructor(t,e){this.storage=t,this.walletConnectionSource=e,this.type="http",this.standardUniversalLink="tc://",this.pendingRequests=new Map,this.session=null,this.gateway=null,this.pendingGateways=[],this.listeners=[],this.defaultOpeningDeadlineMS=5e3,this.connectionStorage=new B(t)}static fromStorage(t){return i(this,void 0,void 0,function*(){const e=new B(t),n=yield e.getHttpConnection();return K(n)?new F(t,n.connectionSource):new F(t,{bridgeUrl:n.session.bridgeUrl})})}connect(t,e){var n;const o=k(null==e?void 0:e.signal);null===(n=this.abortController)||void 0===n||n.abort(),this.abortController=o,this.closeGateways();const s=new r.SessionCrypto;this.session={sessionCrypto:s,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},this.connectionStorage.storeConnection({type:"http",connectionSource:this.walletConnectionSource,sessionCrypto:s}).then(()=>i(this,void 0,void 0,function*(){o.signal.aborted||(yield P(t=>this.openGateways(s,{openingDeadlineMS:null==e?void 0:e.openingDeadlineMS,signal:null==t?void 0:t.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:o.signal}))}));const a="universalLink"in this.walletConnectionSource&&this.walletConnectionSource.universalLink?this.walletConnectionSource.universalLink:this.standardUniversalLink;return this.generateUniversalLink(a,t)}restoreConnection(t){var e,n;return i(this,void 0,void 0,function*(){const r=k(null==t?void 0:t.signal);if(null===(e=this.abortController)||void 0===e||e.abort(),this.abortController=r,r.signal.aborted)return;this.closeGateways();const o=yield this.connectionStorage.getHttpConnection();if(!o)return;if(r.signal.aborted)return;const i=null!==(n=null==t?void 0:t.openingDeadlineMS)&&void 0!==n?n:this.defaultOpeningDeadlineMS;if(K(o))return this.session={sessionCrypto:o.sessionCrypto,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},yield this.openGateways(o.sessionCrypto,{openingDeadlineMS:i,signal:null==r?void 0:r.signal});if(Array.isArray(this.walletConnectionSource))throw new s("Internal error. Connection source is array while WalletConnectionSourceHTTP was expected.");if(this.session=o.session,this.gateway&&(I("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new M(this.storage,this.walletConnectionSource.bridgeUrl,o.session.sessionCrypto.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),!r.signal.aborted){this.listeners.forEach(t=>t(o.connectEvent));try{yield P(t=>this.gateway.registerSession({openingDeadlineMS:i,signal:t.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:r.signal})}catch(a){return void(yield this.disconnect({signal:r.signal}))}}})}sendRequest(t,e){const n={};return"function"==typeof e?n.onRequestSent=e:(n.onRequestSent=null==e?void 0:e.onRequestSent,n.signal=null==e?void 0:e.signal,n.attempts=null==e?void 0:e.attempts),new Promise((e,o)=>i(this,void 0,void 0,function*(){var i;if(!(this.gateway&&this.session&&"walletPublicKey"in this.session))throw new s("Trying to send bridge request without session");const a=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),I("Send http-bridge request:",Object.assign(Object.assign({},t),{id:a}));const c=this.session.sessionCrypto.encrypt(JSON.stringify(Object.assign(Object.assign({},t),{id:a})),r.hexToByteArray(this.session.walletPublicKey));try{yield this.gateway.send(c,this.session.walletPublicKey,t.method,{attempts:null==n?void 0:n.attempts,signal:null==n?void 0:n.signal}),null===(i=null==n?void 0:n.onRequestSent)||void 0===i||i.call(n),this.pendingRequests.set(a.toString(),e)}catch(l){o(l)}}))}closeConnection(){this.closeGateways(),this.listeners=[],this.session=null,this.gateway=null}disconnect(t){return i(this,void 0,void 0,function*(){return new Promise(e=>i(this,void 0,void 0,function*(){let n=!1,r=null;const o=()=>{n||(n=!0,this.removeBridgeAndSession().then(e))};try{this.closeGateways();const s=k(null==t?void 0:t.signal);r=setTimeout(()=>{s.abort()},this.defaultOpeningDeadlineMS),yield this.sendRequest({method:"disconnect",params:[]},{onRequestSent:o,signal:s.signal,attempts:1})}catch(i){I("Disconnect error:",i),n||this.removeBridgeAndSession().then(e)}finally{r&&clearTimeout(r),o()}}))})}listen(t){return this.listeners.push(t),()=>this.listeners=this.listeners.filter(e=>e!==t)}pause(){var t;null===(t=this.gateway)||void 0===t||t.pause(),this.pendingGateways.forEach(t=>t.pause())}unPause(){return i(this,void 0,void 0,function*(){const t=this.pendingGateways.map(t=>t.unPause());this.gateway&&t.push(this.gateway.unPause()),yield Promise.all(t)})}pendingGatewaysListener(t,e,n){return i(this,void 0,void 0,function*(){if(this.pendingGateways.includes(t))return this.closeGateways({except:t}),this.gateway&&(I("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.session.bridgeUrl=e,this.gateway=t,this.gateway.setErrorsListener(this.gatewayErrorsListener.bind(this)),this.gateway.setListener(this.gatewayListener.bind(this)),this.gatewayListener(n);yield t.close()})}gatewayListener(t){return i(this,void 0,void 0,function*(){const e=JSON.parse(this.session.sessionCrypto.decrypt(r.Base64.decode(t.message).toUint8Array(),r.hexToByteArray(t.from)));if(I("Wallet message received:",e),!("event"in e)){const t=e.id.toString(),n=this.pendingRequests.get(t);return n?(n(e),void this.pendingRequests.delete(t)):void I(`Response id ${t} doesn't match any request's id`)}if(void 0!==e.id){const t=yield this.connectionStorage.getLastWalletEventId();if(void 0!==t&&e.id<=t)return void j(`Received event id (=${e.id}) must be greater than stored last wallet event id (=${t}) `);"connect"!==e.event&&(yield this.connectionStorage.storeLastWalletEventId(e.id))}const n=this.listeners;"connect"===e.event&&(yield this.updateSession(e,t.from)),"disconnect"===e.event&&(I("Removing bridge and session: received disconnect event"),yield this.removeBridgeAndSession()),n.forEach(t=>t(e))})}gatewayErrorsListener(t){return i(this,void 0,void 0,function*(){throw new s(`Bridge error ${JSON.stringify(t)}`)})}updateSession(t,e){return i(this,void 0,void 0,function*(){this.session=Object.assign(Object.assign({},this.session),{walletPublicKey:e});const n=t.payload.items.find(t=>"ton_addr"===t.name),r=Object.assign(Object.assign({},t),{payload:Object.assign(Object.assign({},t.payload),{items:[n]})});yield this.connectionStorage.storeConnection({type:"http",session:this.session,lastWalletEventId:t.id,connectEvent:r,nextRpcRequestId:0})})}removeBridgeAndSession(){return i(this,void 0,void 0,function*(){this.closeConnection(),yield this.connectionStorage.removeConnection()})}generateUniversalLink(t,e){return N(t)?this.generateTGUniversalLink(t,e):this.generateRegularUniversalLink(t,e)}generateRegularUniversalLink(t,e){const n=new URL(t);return n.searchParams.append("v",q.toString()),n.searchParams.append("id",this.session.sessionCrypto.sessionId),n.searchParams.append("r",JSON.stringify(e)),n.toString()}generateTGUniversalLink(t,e){const n="tonconnect-"+A(this.generateRegularUniversalLink("about:blank",e).split("?")[1]),r=this.convertToDirectLink(t),o=new URL(r);return o.searchParams.append("startapp",n),o.toString()}convertToDirectLink(t){const e=new URL(t);return e.searchParams.has("attach")&&(e.searchParams.delete("attach"),e.pathname+="/start"),e.toString()}openGateways(t,e){return i(this,void 0,void 0,function*(){return Array.isArray(this.walletConnectionSource)?(this.pendingGateways.map(t=>t.close().catch()),this.pendingGateways=this.walletConnectionSource.map(e=>{const n=new M(this.storage,e.bridgeUrl,t.sessionId,()=>{},()=>{});return n.setListener(t=>this.pendingGatewaysListener(n,e.bridgeUrl,t)),n}),void(yield Promise.allSettled(this.pendingGateways.map(t=>P(n=>this.pendingGateways.some(e=>e===t)?t.registerSession({openingDeadlineMS:null==e?void 0:e.openingDeadlineMS,signal:n.signal}):t.close(),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:null==e?void 0:e.signal}))))):(this.gateway&&(I("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new M(this.storage,this.walletConnectionSource.bridgeUrl,t.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),yield this.gateway.registerSession({openingDeadlineMS:null==e?void 0:e.openingDeadlineMS,signal:null==e?void 0:e.signal}))})}closeGateways(t){var e;null===(e=this.gateway)||void 0===e||e.close(),this.pendingGateways.filter(e=>e!==(null==t?void 0:t.except)).forEach(t=>t.close()),this.pendingGateways=[]}}function G(t,e){return H(t,[e])}function H(t,e){return!(!t||"object"!=typeof t)&&e.every(e=>e in t)}function $(t){try{return!(!G(t,"tonconnect")||!G(t.tonconnect,"walletInfo"))&&H(t.tonconnect.walletInfo,["name","app_name","image","about_url","platforms"])}catch(e){return!1}}class V{constructor(){this.storage={}}static getInstance(){return V.instance||(V.instance=new V),V.instance}get length(){return Object.keys(this.storage).length}clear(){this.storage={}}getItem(t){var e;return null!==(e=this.storage[t])&&void 0!==e?e:null}key(t){var e;const n=Object.keys(this.storage);return t<0||t>=n.length?null:null!==(e=n[t])&&void 0!==e?e:null}removeItem(t){delete this.storage[t]}setItem(t,e){this.storage[t]=e}}function J(){if("undefined"!=typeof window)return window}function Y(){const t=J();if(!t)return[];try{return Object.keys(t)}catch(e){return[]}}function z(){if("undefined"!=typeof document)return document}function Q(){var t;const e=null===(t=J())||void 0===t?void 0:t.location.origin;return e?e+"/tonconnect-manifest.json":""}function Z(){if(X())return localStorage;if(void 0!==e&&null!=e.versions&&null!=e.versions.node)throw new s("`localStorage` is unavailable, but it is required for TonConnect. For more details, see https://github.com/ton-connect/sdk/tree/main/packages/sdk#init-connector");return V.getInstance()}function X(){try{return"undefined"!=typeof localStorage}catch(t){return!1}}class tt{constructor(t,e){this.injectedWalletKey=e,this.type="injected",this.unsubscribeCallback=null,this.listenSubscriptions=!1,this.listeners=[];const n=tt.window;if(!tt.isWindowContainsWallet(n,e))throw new g;this.connectionStorage=new B(t),this.injectedWallet=n[e].tonconnect}static fromStorage(t){return i(this,void 0,void 0,function*(){const e=new B(t),n=yield e.getInjectedConnection();return new tt(t,n.jsBridgeKey)})}static isWalletInjected(t){return tt.isWindowContainsWallet(this.window,t)}static isInsideWalletBrowser(t){return!!tt.isWindowContainsWallet(this.window,t)&&this.window[t].tonconnect.isWalletBrowser}static getCurrentlyInjectedWallets(){return this.window?Y().filter(([t,e])=>$(e)).map(([t,e])=>({name:e.tonconnect.walletInfo.name,appName:e.tonconnect.walletInfo.app_name,aboutUrl:e.tonconnect.walletInfo.about_url,imageUrl:e.tonconnect.walletInfo.image,tondns:e.tonconnect.walletInfo.tondns,jsBridgeKey:t,injected:!0,embedded:e.tonconnect.isWalletBrowser,platforms:e.tonconnect.walletInfo.platforms})):[]}static isWindowContainsWallet(t,e){return!!t&&e in t&&"object"==typeof t[e]&&"tonconnect"in t[e]}connect(t){this._connect(q,t)}restoreConnection(){return i(this,void 0,void 0,function*(){try{I("Injected Provider restoring connection...");const e=yield this.injectedWallet.restoreConnection();I("Injected Provider restoring connection response",e),"connect"===e.event?(this.makeSubscriptions(),this.listeners.forEach(t=>t(e))):yield this.connectionStorage.removeConnection()}catch(t){yield this.connectionStorage.removeConnection(),console.error(t)}})}closeConnection(){this.listenSubscriptions&&this.injectedWallet.disconnect(),this.closeAllListeners()}disconnect(){return i(this,void 0,void 0,function*(){return new Promise(t=>{const e=()=>{this.closeAllListeners(),this.connectionStorage.removeConnection().then(t)};try{this.injectedWallet.disconnect(),e()}catch(n){I(n),this.sendRequest({method:"disconnect",params:[]},e)}})})}closeAllListeners(){var t;this.listenSubscriptions=!1,this.listeners=[],null===(t=this.unsubscribeCallback)||void 0===t||t.call(this)}listen(t){return this.listeners.push(t),()=>this.listeners=this.listeners.filter(e=>e!==t)}sendRequest(t,e){var n;return i(this,void 0,void 0,function*(){const r={};"function"==typeof e?r.onRequestSent=e:(r.onRequestSent=null==e?void 0:e.onRequestSent,r.signal=null==e?void 0:e.signal);const o=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),I("Send injected-bridge request:",Object.assign(Object.assign({},t),{id:o}));const i=this.injectedWallet.send(Object.assign(Object.assign({},t),{id:o}));return i.then(t=>I("Wallet message received:",t)),null===(n=null==r?void 0:r.onRequestSent)||void 0===n||n.call(r),i})}_connect(t,e){return i(this,void 0,void 0,function*(){try{I(`Injected Provider connect request: protocolVersion: ${t}, message:`,e);const r=yield this.injectedWallet.connect(t,e);I("Injected Provider connect response:",r),"connect"===r.event&&(yield this.updateSession(),this.makeSubscriptions()),this.listeners.forEach(t=>t(r))}catch(n){I("Injected Provider connect error:",n);const t={event:"connect_error",payload:{code:0,message:null==n?void 0:n.toString()}};this.listeners.forEach(e=>e(t))}})}makeSubscriptions(){this.listenSubscriptions=!0,this.unsubscribeCallback=this.injectedWallet.listen(t=>{I("Wallet message received:",t),this.listenSubscriptions&&this.listeners.forEach(e=>e(t)),"disconnect"===t.event&&this.disconnect()})}updateSession(){return this.connectionStorage.storeConnection({type:"injected",jsBridgeKey:this.injectedWalletKey,nextRpcRequestId:0})}}tt.window=J();class et{constructor(){this.localStorage=Z()}getItem(t){return i(this,void 0,void 0,function*(){return this.localStorage.getItem(t)})}removeItem(t){return i(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}setItem(t,e){return i(this,void 0,void 0,function*(){this.localStorage.setItem(t,e)})}}function nt(t){return ot(t)&&t.injected}function rt(t){return nt(t)&&t.embedded}function ot(t){return"jsBridgeKey"in t}const it=[{app_name:"telegram-wallet",name:"Wallet",image:"https://wallet.tg/images/logo-288.png",about_url:"https://wallet.tg/",universal_url:"https://t.me/wallet?attach=wallet",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"}],platforms:["ios","android","macos","windows","linux"]},{app_name:"tonkeeper",name:"Tonkeeper",image:"https://tonkeeper.com/assets/tonconnect-icon.png",tondns:"tonkeeper.ton",about_url:"https://tonkeeper.com",universal_url:"https://app.tonkeeper.com/ton-connect",deepLink:"tonkeeper-tc://",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"},{type:"js",key:"tonkeeper"}],platforms:["ios","android","chrome","firefox","macos"]},{app_name:"mytonwallet",name:"MyTonWallet",image:"https://mytonwallet.io/icon-256.png",about_url:"https://mytonwallet.io",universal_url:"https://connect.mytonwallet.org",bridge:[{type:"js",key:"mytonwallet"},{type:"sse",url:"https://tonconnectbridge.mytonwallet.org/bridge/"}],platforms:["chrome","windows","macos","linux","ios","android","firefox"]},{app_name:"openmask",name:"OpenMask",image:"https://raw.githubusercontent.com/OpenProduct/openmask-extension/main/public/openmask-logo-288.png",about_url:"https://www.openmask.app/",bridge:[{type:"js",key:"openmask"}],platforms:["chrome"]},{app_name:"tonhub",name:"Tonhub",image:"https://tonhub.com/tonconnect_logo.png",about_url:"https://tonhub.com",universal_url:"https://tonhub.com/ton-connect",bridge:[{type:"js",key:"tonhub"},{type:"sse",url:"https://connect.tonhubapi.com/tonconnect"}],platforms:["ios","android"]},{app_name:"dewallet",name:"DeWallet",image:"https://app.delabwallet.com/logo_black.png",about_url:"https://delabwallet.com",bridge:[{type:"js",key:"dewallet"}],platforms:["chrome"]},{app_name:"xtonwallet",name:"XTONWallet",image:"https://xtonwallet.com/assets/img/icon-256-back.png",about_url:"https://xtonwallet.com",bridge:[{type:"js",key:"xtonwallet"}],platforms:["chrome","firefox"]},{app_name:"tonwallet",name:"TON Wallet",image:"https://wallet.ton.org/assets/ui/qr-logo.png",about_url:"https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd",bridge:[{type:"js",key:"tonwallet"}],platforms:["chrome"]}];class st{constructor(t){this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null,this.walletsListSource="https://raw.githubusercontent.com/ton-blockchain/wallets-list/main/wallets-v2.json",(null==t?void 0:t.walletsListSource)&&(this.walletsListSource=t.walletsListSource),(null==t?void 0:t.cacheTTLMs)&&(this.cacheTTLMs=t.cacheTTLMs)}getWallets(){return i(this,void 0,void 0,function*(){return this.cacheTTLMs&&this.walletsListCacheCreationTimestamp&&Date.now()>this.walletsListCacheCreationTimestamp+this.cacheTTLMs&&(this.walletsListCache=null),this.walletsListCache||(this.walletsListCache=this.fetchWalletsList(),this.walletsListCache.then(()=>{this.walletsListCacheCreationTimestamp=Date.now()}).catch(()=>{this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null})),this.walletsListCache})}getEmbeddedWallet(){return i(this,void 0,void 0,function*(){const t=(yield this.getWallets()).filter(rt);return 1!==t.length?null:t[0]})}fetchWalletsList(){return i(this,void 0,void 0,function*(){let t=[];try{const e=yield fetch(this.walletsListSource);if(t=yield e.json(),!Array.isArray(t))throw new v("Wrong wallets list format, wallets list must be an array.");const r=t.filter(t=>!this.isCorrectWalletConfigDTO(t));r.length&&(j(`Wallet(s) ${r.map(t=>t.name).join(", ")} config format is wrong. They were removed from the wallets list.`),t=t.filter(t=>this.isCorrectWalletConfigDTO(t)))}catch(n){j(n),t=it}let e=[];try{e=tt.getCurrentlyInjectedWallets()}catch(n){j(n)}return this.mergeWalletsLists(this.walletConfigDTOListToWalletConfigList(t),e)})}walletConfigDTOListToWalletConfigList(t){return t.map(t=>{const e={name:t.name,appName:t.app_name,imageUrl:t.image,aboutUrl:t.about_url,tondns:t.tondns,platforms:t.platforms};return t.bridge.forEach(n=>{if("sse"===n.type&&(e.bridgeUrl=n.url,e.universalLink=t.universal_url,e.deepLink=t.deepLink),"js"===n.type){const t=n.key;e.jsBridgeKey=t,e.injected=tt.isWalletInjected(t),e.embedded=tt.isInsideWalletBrowser(t)}}),e})}mergeWalletsLists(t,e){return[...new Set(t.concat(e).map(t=>t.name)).values()].map(n=>{const r=t.find(t=>t.name===n),o=e.find(t=>t.name===n);return Object.assign(Object.assign({},r&&Object.assign({},r)),o&&Object.assign({},o))})}isCorrectWalletConfigDTO(t){if(!t||"object"!=typeof t)return!1;if(!("name"in t&&"image"in t&&"about_url"in t&&"platforms"in t&&"app_name"in t))return!1;if(!t.platforms||!Array.isArray(t.platforms)||!t.platforms.length)return!1;if(!("bridge"in t&&Array.isArray(t.bridge)&&t.bridge.length))return!1;const e=t.bridge;if(e.some(t=>!(t&&"object"==typeof t&&"type"in t)))return!1;const n=e.find(t=>"sse"===t.type);if(n&&!("url"in n&&n.url&&t.universal_url))return!1;const r=e.find(t=>"js"===t.type);return!(r&&!("key"in r&&r.key))}}class at extends s{get info(){return"Wallet doesn't support requested feature method."}constructor(...t){super(...t),Object.setPrototypeOf(this,at.prototype)}}function ct(t,e){const n=t.includes("SendTransaction"),r=t.find(t=>t&&"object"==typeof t&&"SendTransaction"===t.name);if(!n&&!r)throw new at("Wallet doesn't support SendTransaction feature.");if(r&&void 0!==r.maxMessages){if(r.maxMessages<e.requiredMessagesNumber)throw new at(`Wallet is not able to handle such SendTransaction request. Max support messages number is ${r.maxMessages}, but ${e.requiredMessagesNumber} is required.`)}else D("Connected wallet didn't provide information about max allowed messages in the SendTransaction request. Request may be rejected by the wallet.")}function lt(t){return{type:"response-version",version:t}}function ut(t){return{ton_connect_sdk_lib:t.ton_connect_sdk_lib,ton_connect_ui_lib:t.ton_connect_ui_lib}}function dt(t,e){var n,r,o,i,s,a,c,l;const u=(null===(n=null==e?void 0:e.connectItems)||void 0===n?void 0:n.tonProof)&&"proof"in e.connectItems.tonProof?"ton_proof":"ton_addr";return{wallet_address:null!==(o=null===(r=null==e?void 0:e.account)||void 0===r?void 0:r.address)&&void 0!==o?o:null,wallet_type:null!==(i=null==e?void 0:e.device.appName)&&void 0!==i?i:null,wallet_version:null!==(s=null==e?void 0:e.device.appVersion)&&void 0!==s?s:null,auth_type:u,custom_data:Object.assign({chain_id:null!==(c=null===(a=null==e?void 0:e.account)||void 0===a?void 0:a.chain)&&void 0!==c?c:null,provider:null!==(l=null==e?void 0:e.provider)&&void 0!==l?l:null},ut(t))}}function ht(t){return{type:"connection-started",custom_data:ut(t)}}function ft(t,e){return Object.assign({type:"connection-completed",is_success:!0},dt(t,e))}function pt(t,e,n){return{type:"connection-error",is_success:!1,error_message:e,error_code:null!=n?n:null,custom_data:ut(t)}}function gt(t){return{type:"connection-restoring-started",custom_data:ut(t)}}function yt(t,e){return Object.assign({type:"connection-restoring-completed",is_success:!0},dt(t,e))}function vt(t,e){return{type:"connection-restoring-error",is_success:!1,error_message:e,custom_data:ut(t)}}function wt(t,e){var n,r,o,i;return{valid_until:null!==(n=String(e.validUntil))&&void 0!==n?n:null,from:null!==(i=null!==(r=e.from)&&void 0!==r?r:null===(o=null==t?void 0:t.account)||void 0===o?void 0:o.address)&&void 0!==i?i:null,messages:e.messages.map(t=>{var e,n;return{address:null!==(e=t.address)&&void 0!==e?e:null,amount:null!==(n=t.amount)&&void 0!==n?n:null}})}}function bt(t,e,n){return Object.assign(Object.assign({type:"transaction-sent-for-signature"},dt(t,e)),wt(e,n))}function Et(t,e,n,r){return Object.assign(Object.assign({type:"transaction-signed",is_success:!0,signed_transaction:r.boc},dt(t,e)),wt(e,n))}function mt(t,e,n,r,o){return Object.assign(Object.assign({type:"transaction-signing-failed",is_success:!1,error_message:r,error_code:null!=o?o:null},dt(t,e)),wt(e,n))}function _t(t,e,n){return Object.assign({type:"disconnection",scope:n},dt(t,e))}class Rt{constructor(){this.window=J()}dispatchEvent(t,e){var n;return i(this,void 0,void 0,function*(){const r=new CustomEvent(t,{detail:e});null===(n=this.window)||void 0===n||n.dispatchEvent(r)})}addEventListener(t,e,n){var r;return i(this,void 0,void 0,function*(){return null===(r=this.window)||void 0===r||r.addEventListener(t,e,n),()=>{var n;return null===(n=this.window)||void 0===n?void 0:n.removeEventListener(t,e)}})}}class St{constructor(t){var e;this.eventPrefix="ton-connect-",this.tonConnectUiVersion=null,this.eventDispatcher=null!==(e=null==t?void 0:t.eventDispatcher)&&void 0!==e?e:new Rt,this.tonConnectSdkVersion=t.tonConnectSdkVersion,this.init().catch()}get version(){return ut({ton_connect_sdk_lib:this.tonConnectSdkVersion,ton_connect_ui_lib:this.tonConnectUiVersion})}init(){return i(this,void 0,void 0,function*(){try{yield this.setRequestVersionHandler(),this.tonConnectUiVersion=yield this.requestTonConnectUiVersion()}catch(t){}})}setRequestVersionHandler(){return i(this,void 0,void 0,function*(){yield this.eventDispatcher.addEventListener("ton-connect-request-version",()=>i(this,void 0,void 0,function*(){yield this.eventDispatcher.dispatchEvent("ton-connect-response-version",lt(this.tonConnectSdkVersion))}))})}requestTonConnectUiVersion(){return i(this,void 0,void 0,function*(){return new Promise((t,e)=>i(this,void 0,void 0,function*(){try{yield this.eventDispatcher.addEventListener("ton-connect-ui-response-version",e=>{t(e.detail.version)},{once:!0}),yield this.eventDispatcher.dispatchEvent("ton-connect-ui-request-version",{type:"request-version"})}catch(n){e(n)}}))})}dispatchUserActionEvent(t){try{this.eventDispatcher.dispatchEvent(`${this.eventPrefix}${t.type}`,t).catch()}catch(e){}}trackConnectionStarted(...t){try{const n=ht(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackConnectionCompleted(...t){try{const n=ft(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackConnectionError(...t){try{const n=pt(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackConnectionRestoringStarted(...t){try{const n=gt(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackConnectionRestoringCompleted(...t){try{const n=yt(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackConnectionRestoringError(...t){try{const n=vt(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackDisconnection(...t){try{const n=_t(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackTransactionSentForSignature(...t){try{const n=bt(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackTransactionSigned(...t){try{const n=Et(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}trackTransactionSigningFailed(...t){try{const n=mt(this.version,...t);this.dispatchUserActionEvent(n)}catch(e){}}}const Ct="3.0.3";class Ot{constructor(t){if(this.walletsList=new st,this._wallet=null,this.provider=null,this.statusChangeSubscriptions=[],this.statusChangeErrorSubscriptions=[],this.dappSettings={manifestUrl:(null==t?void 0:t.manifestUrl)||Q(),storage:(null==t?void 0:t.storage)||new et},this.walletsList=new st({walletsListSource:null==t?void 0:t.walletsListSource,cacheTTLMs:null==t?void 0:t.walletsListCacheTTLMs}),this.tracker=new St({eventDispatcher:null==t?void 0:t.eventDispatcher,tonConnectSdkVersion:Ct}),!this.dappSettings.manifestUrl)throw new a("Dapp tonconnect-manifest.json must be specified if window.location.origin is undefined. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest");this.bridgeConnectionStorage=new B(this.dappSettings.storage),(null==t?void 0:t.disableAutoPauseConnection)||this.addWindowFocusAndBlurSubscriptions()}static getWallets(){return this.walletsList.getWallets()}get connected(){return null!==this._wallet}get account(){var t;return(null===(t=this._wallet)||void 0===t?void 0:t.account)||null}get wallet(){return this._wallet}set wallet(t){this._wallet=t,this.statusChangeSubscriptions.forEach(t=>t(this._wallet))}getWallets(){return this.walletsList.getWallets()}onStatusChange(t,e){return this.statusChangeSubscriptions.push(t),e&&this.statusChangeErrorSubscriptions.push(e),()=>{this.statusChangeSubscriptions=this.statusChangeSubscriptions.filter(e=>e!==t),e&&(this.statusChangeErrorSubscriptions=this.statusChangeErrorSubscriptions.filter(t=>t!==e))}}connect(t,e){var n,r;const o={};if("object"==typeof e&&"tonProof"in e&&(o.request=e),"object"==typeof e&&("openingDeadlineMS"in e||"signal"in e||"request"in e)&&(o.request=null==e?void 0:e.request,o.openingDeadlineMS=null==e?void 0:e.openingDeadlineMS,o.signal=null==e?void 0:e.signal),this.connected)throw new u;const i=k(null==o?void 0:o.signal);if(null===(n=this.abortController)||void 0===n||n.abort(),this.abortController=i,i.signal.aborted)throw new s("Connection was aborted");return null===(r=this.provider)||void 0===r||r.closeConnection(),this.provider=this.createProvider(t),i.signal.addEventListener("abort",()=>{var t;null===(t=this.provider)||void 0===t||t.closeConnection(),this.provider=null}),this.tracker.trackConnectionStarted(),this.provider.connect(this.createConnectRequest(null==o?void 0:o.request),{openingDeadlineMS:null==o?void 0:o.openingDeadlineMS,signal:i.signal})}restoreConnection(t){var e,n;return i(this,void 0,void 0,function*(){this.tracker.trackConnectionRestoringStarted();const r=k(null==t?void 0:t.signal);if(null===(e=this.abortController)||void 0===e||e.abort(),this.abortController=r,r.signal.aborted)return void this.tracker.trackConnectionRestoringError("Connection restoring was aborted");const[o,s]=yield Promise.all([this.bridgeConnectionStorage.storedConnectionType(),this.walletsList.getEmbeddedWallet()]);if(r.signal.aborted)return void this.tracker.trackConnectionRestoringError("Connection restoring was aborted");let a=null;try{switch(o){case"http":a=yield F.fromStorage(this.dappSettings.storage);break;case"injected":a=yield tt.fromStorage(this.dappSettings.storage);break;default:if(!s)return;a=this.createProvider(s)}}catch(l){return this.tracker.trackConnectionRestoringError("Provider is not restored"),yield this.bridgeConnectionStorage.removeConnection(),null==a||a.closeConnection(),void(a=null)}if(r.signal.aborted)return null==a||a.closeConnection(),void this.tracker.trackConnectionRestoringError("Connection restoring was aborted");if(!a)return j("Provider is not restored"),void this.tracker.trackConnectionRestoringError("Provider is not restored");null===(n=this.provider)||void 0===n||n.closeConnection(),this.provider=a,a.listen(this.walletEventsListener.bind(this));const c=()=>{this.tracker.trackConnectionRestoringError("Connection restoring was aborted"),null==a||a.closeConnection(),a=null};return r.signal.addEventListener("abort",c),yield P(e=>i(this,void 0,void 0,function*(){yield null==a?void 0:a.restoreConnection({openingDeadlineMS:null==t?void 0:t.openingDeadlineMS,signal:e.signal}),r.signal.removeEventListener("abort",c),this.connected?this.tracker.trackConnectionRestoringCompleted(this.wallet):this.tracker.trackConnectionRestoringError("Connection restoring failed")}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:null==t?void 0:t.signal})})}sendTransaction(t,e){return i(this,void 0,void 0,function*(){const n={};"function"==typeof e?n.onRequestSent=e:(n.onRequestSent=null==e?void 0:e.onRequestSent,n.signal=null==e?void 0:e.signal);const r=k(null==n?void 0:n.signal);if(r.signal.aborted)throw new s("Transaction sending was aborted");this.checkConnection(),ct(this.wallet.device.features,{requiredMessagesNumber:t.messages.length}),this.tracker.trackTransactionSentForSignature(this.wallet,t);const{validUntil:i}=t,a=o(t,["validUntil"]),c=t.from||this.account.address,l=t.network||this.account.chain,u=yield this.provider.sendRequest(S.convertToRpcRequest(Object.assign(Object.assign({},a),{valid_until:i,from:c,network:l})),{onRequestSent:n.onRequestSent,signal:r.signal});if(S.isError(u))return this.tracker.trackTransactionSigningFailed(this.wallet,t,u.error.message,u.error.code),S.parseAndThrowError(u);const d=S.convertFromRpcResponse(u);return this.tracker.trackTransactionSigned(this.wallet,t,d),d})}disconnect(t){var e;return i(this,void 0,void 0,function*(){if(!this.connected)throw new d;const n=k(null==t?void 0:t.signal),r=this.abortController;if(this.abortController=n,n.signal.aborted)throw new s("Disconnect was aborted");this.onWalletDisconnected("dapp"),yield null===(e=this.provider)||void 0===e?void 0:e.disconnect({signal:n.signal}),null==r||r.abort()})}pauseConnection(){var t;"http"===(null===(t=this.provider)||void 0===t?void 0:t.type)&&this.provider.pause()}unPauseConnection(){var t;return"http"!==(null===(t=this.provider)||void 0===t?void 0:t.type)?Promise.resolve():this.provider.unPause()}addWindowFocusAndBlurSubscriptions(){const t=z();if(t)try{t.addEventListener("visibilitychange",()=>{t.hidden?this.pauseConnection():this.unPauseConnection().catch()})}catch(e){j("Cannot subscribe to the document.visibilitychange: ",e)}}createProvider(t){let e;return(e=!Array.isArray(t)&&"jsBridgeKey"in t?new tt(this.dappSettings.storage,t.jsBridgeKey):new F(this.dappSettings.storage,t)).listen(this.walletEventsListener.bind(this)),e}walletEventsListener(t){switch(t.event){case"connect":this.onWalletConnected(t.payload);break;case"connect_error":this.onWalletConnectError(t.payload);break;case"disconnect":this.onWalletDisconnected("wallet")}}onWalletConnected(t){const e=t.items.find(t=>"ton_addr"===t.name),n=t.items.find(t=>"ton_proof"===t.name);if(!e)throw new s("ton_addr connection item was not found");const r={device:t.device,provider:this.provider.type,account:{address:e.address,chain:e.network,walletStateInit:e.walletStateInit,publicKey:e.publicKey}};n&&(r.connectItems={tonProof:n}),this.wallet=r,this.tracker.trackConnectionCompleted(r)}onWalletConnectError(t){const e=_.parseError(t);if(this.statusChangeErrorSubscriptions.forEach(t=>t(e)),I(e),this.tracker.trackConnectionError(t.message,t.code),e instanceof l||e instanceof c)throw j(e),e}onWalletDisconnected(t){this.tracker.trackDisconnection(this.wallet,t),this.wallet=null}checkConnection(){if(!this.connected)throw new d}createConnectRequest(t){const e=[{name:"ton_addr"}];return(null==t?void 0:t.tonProof)&&e.push({name:"ton_proof",payload:t.tonProof}),{manifestUrl:this.dappSettings.manifestUrl,items:e}}}Ot.walletsList=new st,Ot.isWalletInjected=t=>tt.isWalletInjected(t),Ot.isInsideWalletBrowser=t=>tt.isInsideWalletBrowser(t);function Tt(t){if(!t.includes(":"))throw new w(`Wrong address ${t}. Address must include ":".`);const e=t.split(":");if(2!==e.length)throw new w(`Wrong address ${t}. Address must include ":" only once.`);const n=parseInt(e[0]);if(0!==n&&-1!==n)throw new w(`Wrong address ${t}. WC must be eq 0 or -1, but ${n} received.`);const r=e[1];if(64!==(null==r?void 0:r.length))throw new w(`Wrong address ${t}. Hex part must be 64bytes length, but ${null==r?void 0:r.length} received.`);return{wc:n,hex:Ut(r)}}function Nt(t){let e=0;const n=new Uint8Array(t.length+2);n.set(t);for(let r of n){let t=128;for(;t>0;)e<<=1,r&t&&(e+=1),t>>=1,e>65535&&(e&=65535,e^=4129)}return new Uint8Array([Math.floor(e/256),e%256])}const At={};for(let t=0;t<=255;t++){let e=t.toString(16);e.length<2&&(e="0"+e),At[e]=t}function Ut(t){const e=(t=t.toLowerCase()).length;if(e%2!=0)throw new b("Hex string must have length a multiple of 2: "+t);const n=e/2,r=new Uint8Array(n);for(let o=0;o<n;o++){const e=2*o,n=t.substring(e,e+2);if(!At.hasOwnProperty(n))throw new b("Invalid hex character: "+n);r[o]=At[n]}return r}Object.defineProperty(n,"CHAIN",{enumerable:!0,get:function(){return r.CHAIN}}),Object.defineProperty(n,"CONNECT_EVENT_ERROR_CODES",{enumerable:!0,get:function(){return r.CONNECT_EVENT_ERROR_CODES}}),Object.defineProperty(n,"CONNECT_ITEM_ERROR_CODES",{enumerable:!0,get:function(){return r.CONNECT_ITEM_ERROR_CODES}}),Object.defineProperty(n,"SEND_TRANSACTION_ERROR_CODES",{enumerable:!0,get:function(){return r.SEND_TRANSACTION_ERROR_CODES}}),n.BadRequestError=f,n.BrowserEventDispatcher=Rt,n.FetchWalletsError=v,n.LocalstorageNotFoundError=y,n.ParseHexError=b,n.TonConnect=Ot,n.TonConnectError=s,n.UnknownAppError=p,n.UnknownError=E,n.UserRejectsError=h,n.WalletAlreadyConnectedError=u,n.WalletNotConnectedError=d,n.WalletNotInjectedError=g,n.WalletsListManager=st,n.WrongAddressError=w,n.createConnectionCompletedEvent=ft,n.createConnectionErrorEvent=pt,n.createConnectionRestoringCompletedEvent=yt,n.createConnectionRestoringErrorEvent=vt,n.createConnectionRestoringStartedEvent=gt,n.createConnectionStartedEvent=ht,n.createDisconnectionEvent=_t,n.createRequestVersionEvent=function(){return{type:"request-version"}},n.createResponseVersionEvent=lt,n.createTransactionSentForSignatureEvent=bt,n.createTransactionSignedEvent=Et,n.createTransactionSigningFailedEvent=mt,n.createVersionInfo=ut,n.default=Ot,n.encodeTelegramUrlParameters=A,n.isTelegramUrl=N,n.isWalletInfoCurrentlyEmbedded=rt,n.isWalletInfoCurrentlyInjected=nt,n.isWalletInfoInjectable=ot,n.isWalletInfoInjected=function(t){return"jsBridgeKey"in t},n.isWalletInfoRemote=function(t){return"bridgeUrl"in t},n.toUserFriendlyAddress=function(t,e=!1){const{wc:n,hex:o}=Tt(t);let i=81;e&&(i|=128);const s=new Int8Array(34);s[0]=i,s[1]=n,s.set(o,2);const a=new Uint8Array(36);return a.set(s),a.set(Nt(s),34),r.Base64.encode(a).replace(/\+/g,"-").replace(/\//g,"_")}}).call(this,t("_process"))},{"@tonconnect/isomorphic-eventsource":3,"@tonconnect/isomorphic-fetch":4,"@tonconnect/protocol":5,_process:2}],7:[function(t,e){(function(t){(function(t,n){"use strict";void 0!==e&&e.exports?e.exports=n():t.nacl?t.nacl.util=n():(t.nacl={},t.nacl.util=n())})(this,function(){"use strict";var e={};function n(t){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(t))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(t){if("string"!=typeof t)throw new TypeError("expected string");var e,n=unescape(encodeURIComponent(t)),r=new Uint8Array(n.length);for(e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r},e.encodeUTF8=function(t){var e,n=[];for(e=0;e<t.length;e++)n.push(String.fromCharCode(t[e]));return decodeURIComponent(escape(n.join("")))},"undefined"==typeof atob?void 0!==t.from?(e.encodeBase64=function(e){return t.from(e).toString("base64")},e.decodeBase64=function(e){return n(e),new Uint8Array(Array.prototype.slice.call(t.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new t(e).toString("base64")},e.decodeBase64=function(e){return n(e),new Uint8Array(Array.prototype.slice.call(new t(e,"base64"),0))}):(e.encodeBase64=function(t){var e,n=[],r=t.length;for(e=0;e<r;e++)n.push(String.fromCharCode(t[e]));return btoa(n.join(""))},e.decodeBase64=function(t){n(t);var e,r=atob(t),o=new Uint8Array(r.length);for(e=0;e<r.length;e++)o[e]=r.charCodeAt(e);return o}),e})}).call(this,t("buffer").Buffer)},{buffer:1}],8:[function(t,e){(function(e){"use strict";var n=function(t){var e,n=new Float64Array(16);if(t)for(e=0;e<t.length;e++)n[e]=t[e];return n},r=function(){throw new Error("no PRNG")},o=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var s=n(),a=n([1]),c=n([56129,1]),l=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(t,e,n,r){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=255&n,t[e+4]=r>>24&255,t[e+5]=r>>16&255,t[e+6]=r>>8&255,t[e+7]=255&r}function g(t,e,n,r,o){var i,s=0;for(i=0;i<o;i++)s|=t[e+i]^n[r+i];return(1&s-1>>>8)-1}function y(t,e,n,r){return g(t,e,n,r,16)}function v(t,e,n,r){return g(t,e,n,r,32)}function w(t,e,n,r){for(var o,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,l=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,d=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,h=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,f=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,p=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,g=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,y=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,v=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,w=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,E=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,m=i,_=s,R=a,S=c,C=l,O=u,T=d,N=h,A=f,U=p,k=g,P=y,I=v,j=w,D=b,L=E,x=0;x<20;x+=2)m^=(o=(I^=(o=(A^=(o=(C^=(o=m+I|0)<<7|o>>>25)+m|0)<<9|o>>>23)+C|0)<<13|o>>>19)+A|0)<<18|o>>>14,O^=(o=(_^=(o=(j^=(o=(U^=(o=O+_|0)<<7|o>>>25)+O|0)<<9|o>>>23)+U|0)<<13|o>>>19)+j|0)<<18|o>>>14,k^=(o=(T^=(o=(R^=(o=(D^=(o=k+T|0)<<7|o>>>25)+k|0)<<9|o>>>23)+D|0)<<13|o>>>19)+R|0)<<18|o>>>14,L^=(o=(P^=(o=(N^=(o=(S^=(o=L+P|0)<<7|o>>>25)+L|0)<<9|o>>>23)+S|0)<<13|o>>>19)+N|0)<<18|o>>>14,m^=(o=(S^=(o=(R^=(o=(_^=(o=m+S|0)<<7|o>>>25)+m|0)<<9|o>>>23)+_|0)<<13|o>>>19)+R|0)<<18|o>>>14,O^=(o=(C^=(o=(N^=(o=(T^=(o=O+C|0)<<7|o>>>25)+O|0)<<9|o>>>23)+T|0)<<13|o>>>19)+N|0)<<18|o>>>14,k^=(o=(U^=(o=(A^=(o=(P^=(o=k+U|0)<<7|o>>>25)+k|0)<<9|o>>>23)+P|0)<<13|o>>>19)+A|0)<<18|o>>>14,L^=(o=(D^=(o=(j^=(o=(I^=(o=L+D|0)<<7|o>>>25)+L|0)<<9|o>>>23)+I|0)<<13|o>>>19)+j|0)<<18|o>>>14;m=m+i|0,_=_+s|0,R=R+a|0,S=S+c|0,C=C+l|0,O=O+u|0,T=T+d|0,N=N+h|0,A=A+f|0,U=U+p|0,k=k+g|0,P=P+y|0,I=I+v|0,j=j+w|0,D=D+b|0,L=L+E|0,t[0]=m>>>0&255,t[1]=m>>>8&255,t[2]=m>>>16&255,t[3]=m>>>24&255,t[4]=_>>>0&255,t[5]=_>>>8&255,t[6]=_>>>16&255,t[7]=_>>>24&255,t[8]=R>>>0&255,t[9]=R>>>8&255,t[10]=R>>>16&255,t[11]=R>>>24&255,t[12]=S>>>0&255,t[13]=S>>>8&255,t[14]=S>>>16&255,t[15]=S>>>24&255,t[16]=C>>>0&255,t[17]=C>>>8&255,t[18]=C>>>16&255,t[19]=C>>>24&255,t[20]=O>>>0&255,t[21]=O>>>8&255,t[22]=O>>>16&255,t[23]=O>>>24&255,t[24]=T>>>0&255,t[25]=T>>>8&255,t[26]=T>>>16&255,t[27]=T>>>24&255,t[28]=N>>>0&255,t[29]=N>>>8&255,t[30]=N>>>16&255,t[31]=N>>>24&255,t[32]=A>>>0&255,t[33]=A>>>8&255,t[34]=A>>>16&255,t[35]=A>>>24&255,t[36]=U>>>0&255,t[37]=U>>>8&255,t[38]=U>>>16&255,t[39]=U>>>24&255,t[40]=k>>>0&255,t[41]=k>>>8&255,t[42]=k>>>16&255,t[43]=k>>>24&255,t[44]=P>>>0&255,t[45]=P>>>8&255,t[46]=P>>>16&255,t[47]=P>>>24&255,t[48]=I>>>0&255,t[49]=I>>>8&255,t[50]=I>>>16&255,t[51]=I>>>24&255,t[52]=j>>>0&255,t[53]=j>>>8&255,t[54]=j>>>16&255,t[55]=j>>>24&255,t[56]=D>>>0&255,t[57]=D>>>8&255,t[58]=D>>>16&255,t[59]=D>>>24&255,t[60]=L>>>0&255,t[61]=L>>>8&255,t[62]=L>>>16&255,t[63]=L>>>24&255}function b(t,e,n,r){for(var o,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,l=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,d=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,h=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,f=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,p=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,g=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,y=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,v=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,w=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,E=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,m=0;m<20;m+=2)i^=(o=(v^=(o=(f^=(o=(l^=(o=i+v|0)<<7|o>>>25)+i|0)<<9|o>>>23)+l|0)<<13|o>>>19)+f|0)<<18|o>>>14,u^=(o=(s^=(o=(w^=(o=(p^=(o=u+s|0)<<7|o>>>25)+u|0)<<9|o>>>23)+p|0)<<13|o>>>19)+w|0)<<18|o>>>14,g^=(o=(d^=(o=(a^=(o=(b^=(o=g+d|0)<<7|o>>>25)+g|0)<<9|o>>>23)+b|0)<<13|o>>>19)+a|0)<<18|o>>>14,E^=(o=(y^=(o=(h^=(o=(c^=(o=E+y|0)<<7|o>>>25)+E|0)<<9|o>>>23)+c|0)<<13|o>>>19)+h|0)<<18|o>>>14,i^=(o=(c^=(o=(a^=(o=(s^=(o=i+c|0)<<7|o>>>25)+i|0)<<9|o>>>23)+s|0)<<13|o>>>19)+a|0)<<18|o>>>14,u^=(o=(l^=(o=(h^=(o=(d^=(o=u+l|0)<<7|o>>>25)+u|0)<<9|o>>>23)+d|0)<<13|o>>>19)+h|0)<<18|o>>>14,g^=(o=(p^=(o=(f^=(o=(y^=(o=g+p|0)<<7|o>>>25)+g|0)<<9|o>>>23)+y|0)<<13|o>>>19)+f|0)<<18|o>>>14,E^=(o=(b^=(o=(w^=(o=(v^=(o=E+b|0)<<7|o>>>25)+E|0)<<9|o>>>23)+v|0)<<13|o>>>19)+w|0)<<18|o>>>14;t[0]=i>>>0&255,t[1]=i>>>8&255,t[2]=i>>>16&255,t[3]=i>>>24&255,t[4]=u>>>0&255,t[5]=u>>>8&255,t[6]=u>>>16&255,t[7]=u>>>24&255,t[8]=g>>>0&255,t[9]=g>>>8&255,t[10]=g>>>16&255,t[11]=g>>>24&255,t[12]=E>>>0&255,t[13]=E>>>8&255,t[14]=E>>>16&255,t[15]=E>>>24&255,t[16]=d>>>0&255,t[17]=d>>>8&255,t[18]=d>>>16&255,t[19]=d>>>24&255,t[20]=h>>>0&255,t[21]=h>>>8&255,t[22]=h>>>16&255,t[23]=h>>>24&255,t[24]=f>>>0&255,t[25]=f>>>8&255,t[26]=f>>>16&255,t[27]=f>>>24&255,t[28]=p>>>0&255,t[29]=p>>>8&255,t[30]=p>>>16&255,t[31]=p>>>24&255}function E(t,e,n,r){w(t,e,n,r)}function m(t,e,n,r){b(t,e,n,r)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function R(t,e,n,r,o,i,s){var a,c,l=new Uint8Array(16),u=new Uint8Array(64);for(c=0;c<16;c++)l[c]=0;for(c=0;c<8;c++)l[c]=i[c];for(;o>=64;){for(E(u,l,s,_),c=0;c<64;c++)t[e+c]=n[r+c]^u[c];for(a=1,c=8;c<16;c++)a=a+(255&l[c])|0,l[c]=255&a,a>>>=8;o-=64,e+=64,r+=64}if(o>0)for(E(u,l,s,_),c=0;c<o;c++)t[e+c]=n[r+c]^u[c];return 0}function S(t,e,n,r,o){var i,s,a=new Uint8Array(16),c=new Uint8Array(64);for(s=0;s<16;s++)a[s]=0;for(s=0;s<8;s++)a[s]=r[s];for(;n>=64;){for(E(c,a,o,_),s=0;s<64;s++)t[e+s]=c[s];for(i=1,s=8;s<16;s++)i=i+(255&a[s])|0,a[s]=255&i,i>>>=8;n-=64,e+=64}if(n>0)for(E(c,a,o,_),s=0;s<n;s++)t[e+s]=c[s];return 0}function C(t,e,n,r,o){var i=new Uint8Array(32);m(i,r,o,_);for(var s=new Uint8Array(8),a=0;a<8;a++)s[a]=r[a+16];return S(t,e,n,s,i)}function O(t,e,n,r,o,i,s){var a=new Uint8Array(32);m(a,i,s,_);for(var c=new Uint8Array(8),l=0;l<8;l++)c[l]=i[l+16];return R(t,e,n,r,o,c,a)}var T=function(t){var e,n,r,o,i,s,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,e=255&t[0]|(255&t[1])<<8,this.r[0]=8191&e,n=255&t[2]|(255&t[3])<<8,this.r[1]=8191&(e>>>13|n<<3),r=255&t[4]|(255&t[5])<<8,this.r[2]=7939&(n>>>10|r<<6),o=255&t[6]|(255&t[7])<<8,this.r[3]=8191&(r>>>7|o<<9),i=255&t[8]|(255&t[9])<<8,this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,s=255&t[10]|(255&t[11])<<8,this.r[6]=8191&(i>>>14|s<<2),a=255&t[12]|(255&t[13])<<8,this.r[7]=8065&(s>>>11|a<<5),c=255&t[14]|(255&t[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&t[16]|(255&t[17])<<8,this.pad[1]=255&t[18]|(255&t[19])<<8,this.pad[2]=255&t[20]|(255&t[21])<<8,this.pad[3]=255&t[22]|(255&t[23])<<8,this.pad[4]=255&t[24]|(255&t[25])<<8,this.pad[5]=255&t[26]|(255&t[27])<<8,this.pad[6]=255&t[28]|(255&t[29])<<8,this.pad[7]=255&t[30]|(255&t[31])<<8};function N(t,e,n,r,o,i){var s=new T(i);return s.update(n,r,o),s.finish(t,e),0}function A(t,e,n,r,o,i){var s=new Uint8Array(16);return N(s,0,n,r,o,i),y(t,e,s,0)}function U(t,e,n,r,o){var i;if(n<32)return-1;for(O(t,0,e,0,n,r,o),N(t,16,t,32,n-32,t),i=0;i<16;i++)t[i]=0;return 0}function k(t,e,n,r,o){var i,s=new Uint8Array(32);if(n<32)return-1;if(C(s,0,32,r,o),0!==A(e,16,e,32,n-32,s))return-1;for(O(t,0,e,0,n,r,o),i=0;i<32;i++)t[i]=0;return 0}function P(t,e){var n;for(n=0;n<16;n++)t[n]=0|e[n]}function I(t){var e,n,r=1;for(e=0;e<16;e++)n=t[e]+r+65535,r=Math.floor(n/65536),t[e]=n-65536*r;t[0]+=r-1+37*(r-1)}function j(t,e,n){for(var r,o=~(n-1),i=0;i<16;i++)r=o&(t[i]^e[i]),t[i]^=r,e[i]^=r}function D(t,e){var r,o,i,s=n(),a=n();for(r=0;r<16;r++)a[r]=e[r];for(I(a),I(a),I(a),o=0;o<2;o++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,j(a,s,1-i)}for(r=0;r<16;r++)t[2*r]=255&a[r],t[2*r+1]=a[r]>>8}function L(t,e){var n=new Uint8Array(32),r=new Uint8Array(32);return D(n,t),D(r,e),v(n,0,r,0)}function x(t){var e=new Uint8Array(32);return D(e,t),1&e[0]}function M(t,e){var n;for(n=0;n<16;n++)t[n]=e[2*n]+(e[2*n+1]<<8);t[15]&=32767}function W(t,e,n){for(var r=0;r<16;r++)t[r]=e[r]+n[r]}function K(t,e,n){for(var r=0;r<16;r++)t[r]=e[r]-n[r]}function B(t,e,n){var r,o,i=0,s=0,a=0,c=0,l=0,u=0,d=0,h=0,f=0,p=0,g=0,y=0,v=0,w=0,b=0,E=0,m=0,_=0,R=0,S=0,C=0,O=0,T=0,N=0,A=0,U=0,k=0,P=0,I=0,j=0,D=0,L=n[0],x=n[1],M=n[2],W=n[3],K=n[4],B=n[5],q=n[6],F=n[7],G=n[8],H=n[9],$=n[10],V=n[11],J=n[12],Y=n[13],z=n[14],Q=n[15];i+=(r=e[0])*L,s+=r*x,a+=r*M,c+=r*W,l+=r*K,u+=r*B,d+=r*q,h+=r*F,f+=r*G,p+=r*H,g+=r*$,y+=r*V,v+=r*J,w+=r*Y,b+=r*z,E+=r*Q,s+=(r=e[1])*L,a+=r*x,c+=r*M,l+=r*W,u+=r*K,d+=r*B,h+=r*q,f+=r*F,p+=r*G,g+=r*H,y+=r*$,v+=r*V,w+=r*J,b+=r*Y,E+=r*z,m+=r*Q,a+=(r=e[2])*L,c+=r*x,l+=r*M,u+=r*W,d+=r*K,h+=r*B,f+=r*q,p+=r*F,g+=r*G,y+=r*H,v+=r*$,w+=r*V,b+=r*J,E+=r*Y,m+=r*z,_+=r*Q,c+=(r=e[3])*L,l+=r*x,u+=r*M,d+=r*W,h+=r*K,f+=r*B,p+=r*q,g+=r*F,y+=r*G,v+=r*H,w+=r*$,b+=r*V,E+=r*J,m+=r*Y,_+=r*z,R+=r*Q,l+=(r=e[4])*L,u+=r*x,d+=r*M,h+=r*W,f+=r*K,p+=r*B,g+=r*q,y+=r*F,v+=r*G,w+=r*H,b+=r*$,E+=r*V,m+=r*J,_+=r*Y,R+=r*z,S+=r*Q,u+=(r=e[5])*L,d+=r*x,h+=r*M,f+=r*W,p+=r*K,g+=r*B,y+=r*q,v+=r*F,w+=r*G,b+=r*H,E+=r*$,m+=r*V,_+=r*J,R+=r*Y,S+=r*z,C+=r*Q,d+=(r=e[6])*L,h+=r*x,f+=r*M,p+=r*W,g+=r*K,y+=r*B,v+=r*q,w+=r*F,b+=r*G,E+=r*H,m+=r*$,_+=r*V,R+=r*J,S+=r*Y,C+=r*z,O+=r*Q,h+=(r=e[7])*L,f+=r*x,p+=r*M,g+=r*W,y+=r*K,v+=r*B,w+=r*q,b+=r*F,E+=r*G,m+=r*H,_+=r*$,R+=r*V,S+=r*J,C+=r*Y,O+=r*z,T+=r*Q,f+=(r=e[8])*L,p+=r*x,g+=r*M,y+=r*W,v+=r*K,w+=r*B,b+=r*q,E+=r*F,m+=r*G,_+=r*H,R+=r*$,S+=r*V,C+=r*J,O+=r*Y,T+=r*z,N+=r*Q,p+=(r=e[9])*L,g+=r*x,y+=r*M,v+=r*W,w+=r*K,b+=r*B,E+=r*q,m+=r*F,_+=r*G,R+=r*H,S+=r*$,C+=r*V,O+=r*J,T+=r*Y,N+=r*z,A+=r*Q,g+=(r=e[10])*L,y+=r*x,v+=r*M,w+=r*W,b+=r*K,E+=r*B,m+=r*q,_+=r*F,R+=r*G,S+=r*H,C+=r*$,O+=r*V,T+=r*J,N+=r*Y,A+=r*z,U+=r*Q,y+=(r=e[11])*L,v+=r*x,w+=r*M,b+=r*W,E+=r*K,m+=r*B,_+=r*q,R+=r*F,S+=r*G,C+=r*H,O+=r*$,T+=r*V,N+=r*J,A+=r*Y,U+=r*z,k+=r*Q,v+=(r=e[12])*L,w+=r*x,b+=r*M,E+=r*W,m+=r*K,_+=r*B,R+=r*q,S+=r*F,C+=r*G,O+=r*H,T+=r*$,N+=r*V,A+=r*J,U+=r*Y,k+=r*z,P+=r*Q,w+=(r=e[13])*L,b+=r*x,E+=r*M,m+=r*W,_+=r*K,R+=r*B,S+=r*q,C+=r*F,O+=r*G,T+=r*H,N+=r*$,A+=r*V,U+=r*J,k+=r*Y,P+=r*z,I+=r*Q,b+=(r=e[14])*L,E+=r*x,m+=r*M,_+=r*W,R+=r*K,S+=r*B,C+=r*q,O+=r*F,T+=r*G,N+=r*H,A+=r*$,U+=r*V,k+=r*J,P+=r*Y,I+=r*z,j+=r*Q,E+=(r=e[15])*L,s+=38*(_+=r*M),a+=38*(R+=r*W),c+=38*(S+=r*K),l+=38*(C+=r*B),u+=38*(O+=r*q),d+=38*(T+=r*F),h+=38*(N+=r*G),f+=38*(A+=r*H),p+=38*(U+=r*$),g+=38*(k+=r*V),y+=38*(P+=r*J),v+=38*(I+=r*Y),w+=38*(j+=r*z),b+=38*(D+=r*Q),i=(r=(i+=38*(m+=r*x))+(o=1)+65535)-65536*(o=Math.floor(r/65536)),s=(r=s+o+65535)-65536*(o=Math.floor(r/65536)),a=(r=a+o+65535)-65536*(o=Math.floor(r/65536)),c=(r=c+o+65535)-65536*(o=Math.floor(r/65536)),l=(r=l+o+65535)-65536*(o=Math.floor(r/65536)),u=(r=u+o+65535)-65536*(o=Math.floor(r/65536)),d=(r=d+o+65535)-65536*(o=Math.floor(r/65536)),h=(r=h+o+65535)-65536*(o=Math.floor(r/65536)),f=(r=f+o+65535)-65536*(o=Math.floor(r/65536)),p=(r=p+o+65535)-65536*(o=Math.floor(r/65536)),g=(r=g+o+65535)-65536*(o=Math.floor(r/65536)),y=(r=y+o+65535)-65536*(o=Math.floor(r/65536)),v=(r=v+o+65535)-65536*(o=Math.floor(r/65536)),w=(r=w+o+65535)-65536*(o=Math.floor(r/65536)),b=(r=b+o+65535)-65536*(o=Math.floor(r/65536)),E=(r=E+o+65535)-65536*(o=Math.floor(r/65536)),i=(r=(i+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(r/65536)),s=(r=s+o+65535)-65536*(o=Math.floor(r/65536)),a=(r=a+o+65535)-65536*(o=Math.floor(r/65536)),c=(r=c+o+65535)-65536*(o=Math.floor(r/65536)),l=(r=l+o+65535)-65536*(o=Math.floor(r/65536)),u=(r=u+o+65535)-65536*(o=Math.floor(r/65536)),d=(r=d+o+65535)-65536*(o=Math.floor(r/65536)),h=(r=h+o+65535)-65536*(o=Math.floor(r/65536)),f=(r=f+o+65535)-65536*(o=Math.floor(r/65536)),p=(r=p+o+65535)-65536*(o=Math.floor(r/65536)),g=(r=g+o+65535)-65536*(o=Math.floor(r/65536)),y=(r=y+o+65535)-65536*(o=Math.floor(r/65536)),v=(r=v+o+65535)-65536*(o=Math.floor(r/65536)),w=(r=w+o+65535)-65536*(o=Math.floor(r/65536)),b=(r=b+o+65535)-65536*(o=Math.floor(r/65536)),E=(r=E+o+65535)-65536*(o=Math.floor(r/65536)),i+=o-1+37*(o-1),t[0]=i,t[1]=s,t[2]=a,t[3]=c,t[4]=l,t[5]=u,t[6]=d,t[7]=h,t[8]=f,t[9]=p,t[10]=g,t[11]=y,t[12]=v,t[13]=w,t[14]=b,t[15]=E}function q(t,e){B(t,e,e)}function F(t,e){var r,o=n();for(r=0;r<16;r++)o[r]=e[r];for(r=253;r>=0;r--)q(o,o),2!==r&&4!==r&&B(o,o,e);for(r=0;r<16;r++)t[r]=o[r]}function G(t,e){var r,o=n();for(r=0;r<16;r++)o[r]=e[r];for(r=250;r>=0;r--)q(o,o),1!==r&&B(o,o,e);for(r=0;r<16;r++)t[r]=o[r]}function H(t,e,r){var o,i,s=new Uint8Array(32),a=new Float64Array(80),l=n(),u=n(),d=n(),h=n(),f=n(),p=n();for(i=0;i<31;i++)s[i]=e[i];for(s[31]=127&e[31]|64,s[0]&=248,M(a,r),i=0;i<16;i++)u[i]=a[i],h[i]=l[i]=d[i]=0;for(l[0]=h[0]=1,i=254;i>=0;--i)j(l,u,o=s[i>>>3]>>>(7&i)&1),j(d,h,o),W(f,l,d),K(l,l,d),W(d,u,h),K(u,u,h),q(h,f),q(p,l),B(l,d,l),B(d,u,f),W(f,l,d),K(l,l,d),q(u,l),K(d,h,p),B(l,d,c),W(l,l,h),B(d,d,l),B(l,h,p),B(h,u,a),q(u,f),j(l,u,o),j(d,h,o);for(i=0;i<16;i++)a[i+16]=l[i],a[i+32]=d[i],a[i+48]=u[i],a[i+64]=h[i];var g=a.subarray(32),y=a.subarray(16);return F(g,g),B(y,y,g),D(t,y),0}function $(t,e){return H(t,e,i)}function V(t,e){return r(e,32),$(t,e)}function J(t,e,n){var r=new Uint8Array(32);return H(r,n,e),m(t,o,r,_)}T.prototype.blocks=function(t,e,n){for(var r,o,i,s,a,c,l,u,d,h,f,p,g,y,v,w,b,E,m,_=this.fin?0:2048,R=this.h[0],S=this.h[1],C=this.h[2],O=this.h[3],T=this.h[4],N=this.h[5],A=this.h[6],U=this.h[7],k=this.h[8],P=this.h[9],I=this.r[0],j=this.r[1],D=this.r[2],L=this.r[3],x=this.r[4],M=this.r[5],W=this.r[6],K=this.r[7],B=this.r[8],q=this.r[9];n>=16;)h=d=0,h+=(R+=8191&(r=255&t[e+0]|(255&t[e+1])<<8))*I,h+=5*(S+=8191&(r>>>13|(o=255&t[e+2]|(255&t[e+3])<<8)<<3))*q,h+=5*(C+=8191&(o>>>10|(i=255&t[e+4]|(255&t[e+5])<<8)<<6))*B,h+=5*(O+=8191&(i>>>7|(s=255&t[e+6]|(255&t[e+7])<<8)<<9))*K,d=(h+=5*(T+=8191&(s>>>4|(a=255&t[e+8]|(255&t[e+9])<<8)<<12))*W)>>>13,h&=8191,h+=5*(N+=a>>>1&8191)*M,h+=5*(A+=8191&(a>>>14|(c=255&t[e+10]|(255&t[e+11])<<8)<<2))*x,h+=5*(U+=8191&(c>>>11|(l=255&t[e+12]|(255&t[e+13])<<8)<<5))*L,h+=5*(k+=8191&(l>>>8|(u=255&t[e+14]|(255&t[e+15])<<8)<<8))*D,f=d+=(h+=5*(P+=u>>>5|_)*j)>>>13,f+=R*j,f+=S*I,f+=5*C*q,f+=5*O*B,d=(f+=5*T*K)>>>13,f&=8191,f+=5*N*W,f+=5*A*M,f+=5*U*x,f+=5*k*L,d+=(f+=5*P*D)>>>13,f&=8191,p=d,p+=R*D,p+=S*j,p+=C*I,p+=5*O*q,d=(p+=5*T*B)>>>13,p&=8191,p+=5*N*K,p+=5*A*W,p+=5*U*M,p+=5*k*x,g=d+=(p+=5*P*L)>>>13,g+=R*L,g+=S*D,g+=C*j,g+=O*I,d=(g+=5*T*q)>>>13,g&=8191,g+=5*N*B,g+=5*A*K,g+=5*U*W,g+=5*k*M,y=d+=(g+=5*P*x)>>>13,y+=R*x,y+=S*L,y+=C*D,y+=O*j,d=(y+=T*I)>>>13,y&=8191,y+=5*N*q,y+=5*A*B,y+=5*U*K,y+=5*k*W,v=d+=(y+=5*P*M)>>>13,v+=R*M,v+=S*x,v+=C*L,v+=O*D,d=(v+=T*j)>>>13,v&=8191,v+=N*I,v+=5*A*q,v+=5*U*B,v+=5*k*K,w=d+=(v+=5*P*W)>>>13,w+=R*W,w+=S*M,w+=C*x,w+=O*L,d=(w+=T*D)>>>13,w&=8191,w+=N*j,w+=A*I,w+=5*U*q,w+=5*k*B,b=d+=(w+=5*P*K)>>>13,b+=R*K,b+=S*W,b+=C*M,b+=O*x,d=(b+=T*L)>>>13,b&=8191,b+=N*D,b+=A*j,b+=U*I,b+=5*k*q,E=d+=(b+=5*P*B)>>>13,E+=R*B,E+=S*K,E+=C*W,E+=O*M,d=(E+=T*x)>>>13,E&=8191,E+=N*L,E+=A*D,E+=U*j,E+=k*I,m=d+=(E+=5*P*q)>>>13,m+=R*q,m+=S*B,m+=C*K,m+=O*W,d=(m+=T*M)>>>13,m&=8191,m+=N*x,m+=A*L,m+=U*D,m+=k*j,R=h=8191&(d=(d=((d+=(m+=P*I)>>>13)<<2)+d|0)+(h&=8191)|0),S=f+=d>>>=13,C=p&=8191,O=g&=8191,T=y&=8191,N=v&=8191,A=w&=8191,U=b&=8191,k=E&=8191,P=m&=8191,e+=16,n-=16;this.h[0]=R,this.h[1]=S,this.h[2]=C,this.h[3]=O,this.h[4]=T,this.h[5]=N,this.h[6]=A,this.h[7]=U,this.h[8]=k,this.h[9]=P},T.prototype.finish=function(t,e){var n,r,o,i,s=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=n,n=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,s[0]=this.h[0]+5,n=s[0]>>>13,s[0]&=8191,i=1;i<10;i++)s[i]=this.h[i]+n,n=s[i]>>>13,s[i]&=8191;for(s[9]-=8192,r=(1^n)-1,i=0;i<10;i++)s[i]&=r;for(r=~r,i=0;i<10;i++)this.h[i]=this.h[i]&r|s[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,i=1;i<8;i++)o=(this.h[i]+this.pad[i]|0)+(o>>>16)|0,this.h[i]=65535&o;t[e+0]=this.h[0]>>>0&255,t[e+1]=this.h[0]>>>8&255,t[e+2]=this.h[1]>>>0&255,t[e+3]=this.h[1]>>>8&255,t[e+4]=this.h[2]>>>0&255,t[e+5]=this.h[2]>>>8&255,t[e+6]=this.h[3]>>>0&255,t[e+7]=this.h[3]>>>8&255,t[e+8]=this.h[4]>>>0&255,t[e+9]=this.h[4]>>>8&255,t[e+10]=this.h[5]>>>0&255,t[e+11]=this.h[5]>>>8&255,t[e+12]=this.h[6]>>>0&255,t[e+13]=this.h[6]>>>8&255,t[e+14]=this.h[7]>>>0&255,t[e+15]=this.h[7]>>>8&255},T.prototype.update=function(t,e,n){var r,o;if(this.leftover){for((o=16-this.leftover)>n&&(o=n),r=0;r<o;r++)this.buffer[this.leftover+r]=t[e+r];if(n-=o,e+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(o=n-n%16,this.blocks(t,e,o),e+=o,n-=o),n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=t[e+r];this.leftover+=n}};var Y=U,z=k,Q=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Z(t,e,n,r){for(var o,i,s,a,c,l,u,d,h,f,p,g,y,v,w,b,E,m,_,R,S,C,O,T,N,A,U=new Int32Array(16),k=new Int32Array(16),P=t[0],I=t[1],j=t[2],D=t[3],L=t[4],x=t[5],M=t[6],W=t[7],K=e[0],B=e[1],q=e[2],F=e[3],G=e[4],H=e[5],$=e[6],V=e[7],J=0;r>=128;){for(_=0;_<16;_++)R=8*_+J,U[_]=n[R+0]<<24|n[R+1]<<16|n[R+2]<<8|n[R+3],k[_]=n[R+4]<<24|n[R+5]<<16|n[R+6]<<8|n[R+7];for(_=0;_<80;_++)if(o=P,i=I,s=j,a=D,c=L,l=x,u=M,h=K,f=B,p=q,g=F,y=G,v=H,w=$,O=65535&(C=V),T=C>>>16,N=65535&(S=W),A=S>>>16,O+=65535&(C=(G>>>14|L<<18)^(G>>>18|L<<14)^(L>>>9|G<<23)),T+=C>>>16,N+=65535&(S=(L>>>14|G<<18)^(L>>>18|G<<14)^(G>>>9|L<<23)),A+=S>>>16,O+=65535&(C=G&H^~G&$),T+=C>>>16,N+=65535&(S=L&x^~L&M),A+=S>>>16,S=Q[2*_],O+=65535&(C=Q[2*_+1]),T+=C>>>16,N+=65535&S,A+=S>>>16,S=U[_%16],T+=(C=k[_%16])>>>16,N+=65535&S,A+=S>>>16,N+=(T+=(O+=65535&C)>>>16)>>>16,O=65535&(C=m=65535&O|T<<16),T=C>>>16,N=65535&(S=E=65535&N|(A+=N>>>16)<<16),A=S>>>16,O+=65535&(C=(K>>>28|P<<4)^(P>>>2|K<<30)^(P>>>7|K<<25)),T+=C>>>16,N+=65535&(S=(P>>>28|K<<4)^(K>>>2|P<<30)^(K>>>7|P<<25)),A+=S>>>16,T+=(C=K&B^K&q^B&q)>>>16,N+=65535&(S=P&I^P&j^I&j),A+=S>>>16,d=65535&(N+=(T+=(O+=65535&C)>>>16)>>>16)|(A+=N>>>16)<<16,b=65535&O|T<<16,O=65535&(C=g),T=C>>>16,N=65535&(S=a),A=S>>>16,T+=(C=m)>>>16,N+=65535&(S=E),A+=S>>>16,I=o,j=i,D=s,L=a=65535&(N+=(T+=(O+=65535&C)>>>16)>>>16)|(A+=N>>>16)<<16,x=c,M=l,W=u,P=d,B=h,q=f,F=p,G=g=65535&O|T<<16,H=y,$=v,V=w,K=b,_%16==15)for(R=0;R<16;R++)S=U[R],O=65535&(C=k[R]),T=C>>>16,N=65535&S,A=S>>>16,S=U[(R+9)%16],O+=65535&(C=k[(R+9)%16]),T+=C>>>16,N+=65535&S,A+=S>>>16,E=U[(R+1)%16],O+=65535&(C=((m=k[(R+1)%16])>>>1|E<<31)^(m>>>8|E<<24)^(m>>>7|E<<25)),T+=C>>>16,N+=65535&(S=(E>>>1|m<<31)^(E>>>8|m<<24)^E>>>7),A+=S>>>16,E=U[(R+14)%16],T+=(C=((m=k[(R+14)%16])>>>19|E<<13)^(E>>>29|m<<3)^(m>>>6|E<<26))>>>16,N+=65535&(S=(E>>>19|m<<13)^(m>>>29|E<<3)^E>>>6),A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,U[R]=65535&N|A<<16,k[R]=65535&O|T<<16;O=65535&(C=K),T=C>>>16,N=65535&(S=P),A=S>>>16,S=t[0],T+=(C=e[0])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[0]=P=65535&N|A<<16,e[0]=K=65535&O|T<<16,O=65535&(C=B),T=C>>>16,N=65535&(S=I),A=S>>>16,S=t[1],T+=(C=e[1])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[1]=I=65535&N|A<<16,e[1]=B=65535&O|T<<16,O=65535&(C=q),T=C>>>16,N=65535&(S=j),A=S>>>16,S=t[2],T+=(C=e[2])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[2]=j=65535&N|A<<16,e[2]=q=65535&O|T<<16,O=65535&(C=F),T=C>>>16,N=65535&(S=D),A=S>>>16,S=t[3],T+=(C=e[3])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[3]=D=65535&N|A<<16,e[3]=F=65535&O|T<<16,O=65535&(C=G),T=C>>>16,N=65535&(S=L),A=S>>>16,S=t[4],T+=(C=e[4])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[4]=L=65535&N|A<<16,e[4]=G=65535&O|T<<16,O=65535&(C=H),T=C>>>16,N=65535&(S=x),A=S>>>16,S=t[5],T+=(C=e[5])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[5]=x=65535&N|A<<16,e[5]=H=65535&O|T<<16,O=65535&(C=$),T=C>>>16,N=65535&(S=M),A=S>>>16,S=t[6],T+=(C=e[6])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[6]=M=65535&N|A<<16,e[6]=$=65535&O|T<<16,O=65535&(C=V),T=C>>>16,N=65535&(S=W),A=S>>>16,S=t[7],T+=(C=e[7])>>>16,N+=65535&S,A+=S>>>16,A+=(N+=(T+=(O+=65535&C)>>>16)>>>16)>>>16,t[7]=W=65535&N|A<<16,e[7]=V=65535&O|T<<16,J+=128,r-=128}return r}function X(t,e,n){var r,o=new Int32Array(8),i=new Int32Array(8),s=new Uint8Array(256),a=n;for(o[0]=1779033703,o[1]=3144134277,o[2]=1013904242,o[3]=2773480762,o[4]=1359893119,o[5]=2600822924,o[6]=528734635,o[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,Z(o,i,e,n),n%=128,r=0;r<n;r++)s[r]=e[a-n+r];for(s[n]=128,s[(n=256-128*(n<112?1:0))-9]=0,p(s,n-8,a/536870912|0,a<<3),Z(o,i,s,n),r=0;r<8;r++)p(t,8*r,o[r],i[r]);return 0}function tt(t,e){var r=n(),o=n(),i=n(),s=n(),a=n(),c=n(),l=n(),d=n(),h=n();K(r,t[1],t[0]),K(h,e[1],e[0]),B(r,r,h),W(o,t[0],t[1]),W(h,e[0],e[1]),B(o,o,h),B(i,t[3],e[3]),B(i,i,u),B(s,t[2],e[2]),W(s,s,s),K(a,o,r),K(c,s,i),W(l,s,i),W(d,o,r),B(t[0],a,c),B(t[1],d,l),B(t[2],l,c),B(t[3],a,d)}function et(t,e,n){var r;for(r=0;r<4;r++)j(t[r],e[r],n)}function nt(t,e){var r=n(),o=n(),i=n();F(i,e[2]),B(r,e[0],i),B(o,e[1],i),D(t,o),t[31]^=x(r)<<7}function rt(t,e,n){var r,o;for(P(t[0],s),P(t[1],a),P(t[2],a),P(t[3],s),o=255;o>=0;--o)et(t,e,r=n[o/8|0]>>(7&o)&1),tt(e,t),tt(t,t),et(t,e,r)}function ot(t,e){var r=[n(),n(),n(),n()];P(r[0],d),P(r[1],h),P(r[2],a),B(r[3],d,h),rt(t,r,e)}function it(t,e,o){var i,s=new Uint8Array(64),a=[n(),n(),n(),n()];for(o||r(e,32),X(s,e,32),s[0]&=248,s[31]&=127,s[31]|=64,ot(a,s),nt(t,a),i=0;i<32;i++)e[i+32]=t[i];return 0}var st=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function at(t,e){var n,r,o,i;for(r=63;r>=32;--r){for(n=0,o=r-32,i=r-12;o<i;++o)e[o]+=n-16*e[r]*st[o-(r-32)],n=Math.floor((e[o]+128)/256),e[o]-=256*n;e[o]+=n,e[r]=0}for(n=0,o=0;o<32;o++)e[o]+=n-(e[31]>>4)*st[o],n=e[o]>>8,e[o]&=255;for(o=0;o<32;o++)e[o]-=n*st[o];for(r=0;r<32;r++)e[r+1]+=e[r]>>8,t[r]=255&e[r]}function ct(t){var e,n=new Float64Array(64);for(e=0;e<64;e++)n[e]=t[e];for(e=0;e<64;e++)t[e]=0;at(t,n)}function lt(t,e,r,o){var i,s,a=new Uint8Array(64),c=new Uint8Array(64),l=new Uint8Array(64),u=new Float64Array(64),d=[n(),n(),n(),n()];X(a,o,32),a[0]&=248,a[31]&=127,a[31]|=64;var h=r+64;for(i=0;i<r;i++)t[64+i]=e[i];for(i=0;i<32;i++)t[32+i]=a[32+i];for(X(l,t.subarray(32),r+32),ct(l),ot(d,l),nt(t,d),i=32;i<64;i++)t[i]=o[i];for(X(c,t,r+64),ct(c),i=0;i<64;i++)u[i]=0;for(i=0;i<32;i++)u[i]=l[i];for(i=0;i<32;i++)for(s=0;s<32;s++)u[i+s]+=c[i]*a[s];return at(t.subarray(32),u),h}function ut(t,e){var r=n(),o=n(),i=n(),c=n(),u=n(),d=n(),h=n();return P(t[2],a),M(t[1],e),q(i,t[1]),B(c,i,l),K(i,i,t[2]),W(c,t[2],c),q(u,c),q(d,u),B(h,d,u),B(r,h,i),B(r,r,c),G(r,r),B(r,r,i),B(r,r,c),B(r,r,c),B(t[0],r,c),q(o,t[0]),B(o,o,c),L(o,i)&&B(t[0],t[0],f),q(o,t[0]),B(o,o,c),L(o,i)?-1:(x(t[0])===e[31]>>7&&K(t[0],s,t[0]),B(t[3],t[0],t[1]),0)}function dt(t,e,r,o){var i,s=new Uint8Array(32),a=new Uint8Array(64),c=[n(),n(),n(),n()],l=[n(),n(),n(),n()];if(r<64)return-1;if(ut(l,o))return-1;for(i=0;i<r;i++)t[i]=e[i];for(i=0;i<32;i++)t[i+32]=o[i];if(X(a,t,r),ct(a),rt(c,l,a),ot(l,e.subarray(32)),tt(c,l),nt(s,c),r-=64,v(e,0,s,0)){for(i=0;i<r;i++)t[i]=0;return-1}for(i=0;i<r;i++)t[i]=e[i+64];return r}var ht,ft=32,pt=24,gt=32,yt=32,vt=pt;function wt(t,e){if(t.length!==ft)throw new Error("bad key size");if(e.length!==pt)throw new Error("bad nonce size")}function bt(t,e){if(t.length!==gt)throw new Error("bad public key size");if(e.length!==yt)throw new Error("bad secret key size")}function Et(){for(var t=0;t<arguments.length;t++)if(!(arguments[t]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function mt(t){for(var e=0;e<t.length;e++)t[e]=0}e.lowlevel={crypto_core_hsalsa20:m,crypto_stream_xor:O,crypto_stream:C,crypto_stream_salsa20_xor:R,crypto_stream_salsa20:S,crypto_onetimeauth:N,crypto_onetimeauth_verify:A,crypto_verify_16:y,crypto_verify_32:v,crypto_secretbox:U,crypto_secretbox_open:k,crypto_scalarmult:H,crypto_scalarmult_base:$,crypto_box_beforenm:J,crypto_box_afternm:Y,crypto_box:function(t,e,n,r,o,i){var s=new Uint8Array(32);return J(s,o,i),Y(t,e,n,r,s)},crypto_box_open:function(t,e,n,r,o,i){var s=new Uint8Array(32);return J(s,o,i),z(t,e,n,r,s)},crypto_box_keypair:V,crypto_hash:X,crypto_sign:lt,crypto_sign_keypair:it,crypto_sign_open:dt,crypto_secretbox_KEYBYTES:ft,crypto_secretbox_NONCEBYTES:pt,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:gt,crypto_box_SECRETKEYBYTES:yt,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:vt,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:n,D:l,L:st,pack25519:D,unpack25519:M,M:B,A:W,S:q,Z:K,pow2523:G,add:tt,set25519:P,modL:at,scalarmult:rt,scalarbase:ot},e.randomBytes=function(t){var e=new Uint8Array(t);return r(e,t),e},e.secretbox=function(t,e,n){Et(t,e,n),wt(n,e);for(var r=new Uint8Array(32+t.length),o=new Uint8Array(r.length),i=0;i<t.length;i++)r[i+32]=t[i];return U(o,r,r.length,e,n),o.subarray(16)},e.secretbox.open=function(t,e,n){Et(t,e,n),wt(n,e);for(var r=new Uint8Array(16+t.length),o=new Uint8Array(r.length),i=0;i<t.length;i++)r[i+16]=t[i];return r.length<32?null:0!==k(o,r,r.length,e,n)?null:o.subarray(32)},e.secretbox.keyLength=ft,e.secretbox.nonceLength=pt,e.secretbox.overheadLength=16,e.scalarMult=function(t,e){if(Et(t,e),32!==t.length)throw new Error("bad n size");if(32!==e.length)throw new Error("bad p size");var n=new Uint8Array(32);return H(n,t,e),n},e.scalarMult.base=function(t){if(Et(t),32!==t.length)throw new Error("bad n size");var e=new Uint8Array(32);return $(e,t),e},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,n,r,o){var i=e.box.before(r,o);return e.secretbox(t,n,i)},e.box.before=function(t,e){Et(t,e),bt(t,e);var n=new Uint8Array(32);return J(n,t,e),n},e.box.after=e.secretbox,e.box.open=function(t,n,r,o){var i=e.box.before(r,o);return e.secretbox.open(t,n,i)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var t=new Uint8Array(gt),e=new Uint8Array(yt);return V(t,e),{publicKey:t,secretKey:e}},e.box.keyPair.fromSecretKey=function(t){if(Et(t),t.length!==yt)throw new Error("bad secret key size");var e=new Uint8Array(gt);return $(e,t),{publicKey:e,secretKey:new Uint8Array(t)}},e.box.publicKeyLength=gt,e.box.secretKeyLength=yt,e.box.sharedKeyLength=32,e.box.nonceLength=vt,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(t,e){if(Et(t,e),64!==e.length)throw new Error("bad secret key size");var n=new Uint8Array(64+t.length);return lt(n,t,t.length,e),n},e.sign.open=function(t,e){if(Et(t,e),32!==e.length)throw new Error("bad public key size");var n=new Uint8Array(t.length),r=dt(n,t,t.length,e);if(r<0)return null;for(var o=new Uint8Array(r),i=0;i<o.length;i++)o[i]=n[i];return o},e.sign.detached=function(t,n){for(var r=e.sign(t,n),o=new Uint8Array(64),i=0;i<o.length;i++)o[i]=r[i];return o},e.sign.detached.verify=function(t,e,n){if(Et(t,e,n),64!==e.length)throw new Error("bad signature size");if(32!==n.length)throw new Error("bad public key size");var r,o=new Uint8Array(64+t.length),i=new Uint8Array(64+t.length);for(r=0;r<64;r++)o[r]=e[r];for(r=0;r<t.length;r++)o[r+64]=t[r];return dt(i,o,o.length,n)>=0},e.sign.keyPair=function(){var t=new Uint8Array(32),e=new Uint8Array(64);return it(t,e),{publicKey:t,secretKey:e}},e.sign.keyPair.fromSecretKey=function(t){if(Et(t),64!==t.length)throw new Error("bad secret key size");for(var e=new Uint8Array(32),n=0;n<e.length;n++)e[n]=t[32+n];return{publicKey:e,secretKey:new Uint8Array(t)}},e.sign.keyPair.fromSeed=function(t){if(Et(t),32!==t.length)throw new Error("bad seed size");for(var e=new Uint8Array(32),n=new Uint8Array(64),r=0;r<32;r++)n[r]=t[r];return it(e,n,!0),{publicKey:e,secretKey:n}},e.sign.publicKeyLength=32,e.sign.secretKeyLength=64,e.sign.seedLength=32,e.sign.signatureLength=64,e.hash=function(t){Et(t);var e=new Uint8Array(64);return X(e,t,t.length),e},e.hash.hashLength=64,e.verify=function(t,e){return Et(t,e),0!==t.length&&0!==e.length&&t.length===e.length&&0===g(t,0,e,0,t.length)},e.setPRNG=function(t){r=t},(ht="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&ht.getRandomValues?e.setPRNG(function(t,e){var n,r=new Uint8Array(e);for(n=0;n<e;n+=65536)ht.getRandomValues(r.subarray(n,n+Math.min(e-n,65536)));for(n=0;n<e;n++)t[n]=r[n];mt(r)}):void 0!==t&&(ht=t("crypto"))&&ht.randomBytes&&e.setPRNG(function(t,e){var n,r=ht.randomBytes(e);for(n=0;n<e;n++)t[n]=r[n];mt(r)})})(void 0!==e&&e.exports?e.exports:self.nacl=self.nacl||{})},{crypto:1}],Helloworld:[function(t,e,n){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Helloworld");var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(e){i(e)}}function a(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("@tonconnect/sdk"),l=t("@tonconnect/sdk"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return o(e,t),e.prototype.start=function(){return s(this,void 0,void 0,function(){var t=this;return a(this,function(){return this.label.string="",this.connector=new c.default({manifestUrl:"https://archero.ttgames.xyz/manifest/archero.json"}),this.connector.restoreConnection(),this.connector.onStatusChange(function(e){if(e){var n=e.account.address,r=l.toUserFriendlyAddress(n);t.label.string=r}else t.label.string=""}),[2]})})},e.prototype.onConnect=function(){return s(this,void 0,void 0,function(){var t,e;return a(this,function(){return this.connector&&!this.connector.connected&&(t={universalLink:"https://t.me/wallet?attach=wallet",bridgeUrl:"https://bridge.ton.space/bridge"},e=this.connector.connect(t),console.log(e),cc.sys.openURL(e)),[2]})})},e.prototype.onDisconnect=function(){return s(this,void 0,void 0,function(){return a(this,function(){return this.connector&&this.connector.connected&&this.connector.disconnect(),[2]})})},i([h(cc.Label)],e.prototype,"label",void 0),i([h],e.prototype,"text",void 0),i([d],e)}(cc.Component);n.default=f,cc._RF.pop()},{"@tonconnect/sdk":6}]},{},["Helloworld"]);